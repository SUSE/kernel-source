From: Jiri Slaby <jslaby@suse.cz>
Date: Wed, 13 Jul 2022 09:55:24 +0200
Subject: x86/asm/32: fix ANNOTATE_UNRET_SAFE use on 32bit
Patch-mainline: submitted 2022/07/13
References: bsc#1199657 CVE-2022-29900 CVE-2022-29901

The build on x86_32 currently fails after commit 9bb2ec608a20 (objtool:
Update Retpoline validation) with:
arch/x86/kernel/../../x86/xen/xen-head.S:35: Error: no such instruction: `annotate_unret_safe'

ANNOTATE_UNRET_SAFE is defined in nospec-branch.h. And head_32.S is
missing this include. Fix this.

Fixes: 9bb2ec608a20 (objtool: Update Retpoline validation)
Cc: Peter Zijlstra (Intel) <peterz@infradead.org>
Cc: Borislav Petkov <bp@suse.de>
Cc: Josh Poimboeuf <jpoimboe@kernel.org>
Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 arch/x86/kernel/head_32.S |    1 +
 1 file changed, 1 insertion(+)

--- a/arch/x86/kernel/head_32.S
+++ b/arch/x86/kernel/head_32.S
@@ -23,6 +23,7 @@
 #include <asm/cpufeatures.h>
 #include <asm/percpu.h>
 #include <asm/nops.h>
+#include <asm/nospec-branch.h>
 #include <asm/bootparam.h>
 #include <asm/export.h>
 #include <asm/pgtable_32.h>
