From: Kurt Kanzenbach <kurt@linutronix.de>
Date: Thu, 10 Mar 2022 08:35:05 +0100
Subject: flow_dissector: Add support for HSRv0
Patch-mainline: v5.18-rc1
Git-commit: f65e58440d4fca277233ebef78f402a0dbd02da5
References: jsc#PED-376

Commit bf08824a0f47 ("flow_dissector: Add support for HSR") added support for
HSR within the flow dissector. However, it only works for HSR in version
1. Version 0 uses a different Ether Type. Add support for it.

Reported-by: Anthony Harivel <anthony.harivel@linutronix.de>
Signed-off-by: Kurt Kanzenbach <kurt@linutronix.de>
Signed-off-by: David S. Miller <davem@davemloft.net>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 net/core/flow_dissector.c |    1 +
 1 file changed, 1 insertion(+)

--- a/net/core/flow_dissector.c
+++ b/net/core/flow_dissector.c
@@ -1283,6 +1283,7 @@ proto_again:
 		break;
 	}
 
+	case htons(ETH_P_PRP):
 	case htons(ETH_P_HSR): {
 		struct hsr_tag *hdr, _hdr;
 
