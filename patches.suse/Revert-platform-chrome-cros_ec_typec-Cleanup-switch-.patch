From 9169d2fd1f5778295ec4934acd99dc7b35a83fd5 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date: Tue, 19 Jul 2022 13:56:40 +0200
Subject: [PATCH] Revert "platform/chrome: cros_ec_typec: Cleanup switch handle return paths"
Git-commit: 9169d2fd1f5778295ec4934acd99dc7b35a83fd5
Patch-mainline: v6.0-rc1
References: git-fixes

This reverts commit 66fe238a9bcc158f75ddecf976d1ce7efe20f713.

The chrome platform driver changes need to come in through the platform
tree due to some api changes that showed up there that cause build
errors in linux-next

Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
Link: https://lore.kernel.org/r/20220719160821.5e68e30b@oak.ozlabs.ibm.com
Cc: Prashant Malani <pmalani@chromium.org>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/platform/chrome/cros_ec_typec.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/platform/chrome/cros_ec_typec.c b/drivers/platform/chrome/cros_ec_typec.c
index 39e6fd4491a9..7cb2e35c4ded 100644
--- a/drivers/platform/chrome/cros_ec_typec.c
+++ b/drivers/platform/chrome/cros_ec_typec.c
@@ -157,10 +157,12 @@ static int cros_typec_get_switch_handles(struct cros_typec_port *port,
 	return 0;
 
 role_sw_err:
-	typec_switch_put(port->ori_sw);
+	usb_role_switch_put(port->role_sw);
 ori_sw_err:
-	typec_mux_put(port->mux);
+	typec_switch_put(port->ori_sw);
 mux_err:
+	typec_mux_put(port->mux);
+
 	return -ENODEV;
 }
 
-- 
2.35.3

