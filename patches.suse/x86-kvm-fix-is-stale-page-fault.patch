From: Juergen Gross <jgross@suse.com>
Subject: x86/kvm: fix is_stale_page_fault()
Patch-mainline: Never, fixed code is no longer in upstream code
References: bsc#1221333

The mmu_seq parameter of is_page_fault_stale() needs to be of type
unsigned long instead of int, as otherwise the compare with
kvm->mmu_notifier_seq (type unsigned long) will fail after some time.
This will result in endless retries instead of fixes of page faults
as soon as kvm->mmu_notifier_seq is larger than INTMAX.

Signed-off-by: Juergen Gross <jgross@suse.com>
---
 arch/x86/kvm/mmu/mmu.c |   2 +-
 1 file changed, 1 insertions(+), 1 deletions(-)

--- a/arch/x86/kvm/mmu/mmu.c
+++ b/arch/x86/kvm/mmu/mmu.c
@@ -3887,7 +3887,7 @@
  * root was invalidated by a memslot update or a relevant mmu_notifier fired.
  */
 static bool is_page_fault_stale(struct kvm_vcpu *vcpu, kvm_pfn_t pfn,
-				hva_t hva, int mmu_seq)
+				hva_t hva, unsigned long mmu_seq)
 {
 	struct kvm_mmu_page *sp = to_shadow_page(vcpu->arch.mmu->root_hpa);
 
