From 89b0bb232a4c71eeb18f75bfd7aa1ae850025c87 Mon Sep 17 00:00:00 2001
From: Pawel Chmielewski <pawel.chmielewski@linux.intel.com>
Date: Fri, 16 Jan 2026 18:52:49 +0100
Subject: [PATCH] intel_th: pci: Use PCI_DEVICE_DATA() for device entries
Git-commit: 89b0bb232a4c71eeb18f75bfd7aa1ae850025c87
Patch-mainline: v7.0-rc1
References: jsc#PED-13783

Switch PCI_DEVICE() macro to PCI_DEVICE_DATA() to reduce the number of
lines. Add a new header file for the defined names of the devices. Sort
the entries in ascending order.

Signed-off-by: Pawel Chmielewski <pawel.chmielewski@linux.intel.com>
Reviewed-by: Alan Borzeszkowski <alan.borzeszkowski@linux.intel.com>
Reviewed-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Signed-off-by: Alexander Shishkin <alexander.shishkin@linux.intel.com>
Link: https://patch.msgid.link/20260116175250.821002-2-alexander.shishkin@linux.intel.com
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/hwtracing/intel_th/pci.c     | 265 +++++----------------------
 drivers/hwtracing/intel_th/pci_ids.h |  56 ++++++
 2 files changed, 102 insertions(+), 219 deletions(-)
 create mode 100644 drivers/hwtracing/intel_th/pci_ids.h

diff --git a/drivers/hwtracing/intel_th/pci.c b/drivers/hwtracing/intel_th/pci.c
index e3def163d5cf..de069c7aea7c 100644
--- a/drivers/hwtracing/intel_th/pci.c
+++ b/drivers/hwtracing/intel_th/pci.c
@@ -14,6 +14,7 @@
 #include <linux/pci.h>
 
 #include "intel_th.h"
+#include "pci_ids.h"
 
 #define DRIVER_NAME "intel_th_pci"
 
@@ -141,225 +142,51 @@ static const struct intel_th_drvdata intel_th_2x = {
 };
 
 static const struct pci_device_id intel_th_pci_id_table[] = {
-	{
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x9d26),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa126),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Apollo Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x5a8e),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Broxton */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x0a80),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Broxton B-step */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x1a8e),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Kaby Lake PCH-H */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa2a6),
-		.driver_data = (kernel_ulong_t)&intel_th_1x_multi_is_broken,
-	},
-	{
-		/* Denverton */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x19e1),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Lewisburg PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa1a6),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Lewisburg PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa226),
-		.driver_data = (kernel_ulong_t)0,
-	},
-	{
-		/* Gemini Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x318e),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Cannon Lake H */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa326),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Cannon Lake LP */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x9da6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Cedar Fork PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x18e1),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Ice Lake PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x34a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Comet Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x02a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Comet Lake PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x06a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Comet Lake PCH-V */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa3a6),
-		.driver_data = (kernel_ulong_t)&intel_th_1x_multi_is_broken,
-	},
-	{
-		/* Ice Lake NNPI */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x45c5),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Ice Lake CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x8a29),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Tiger Lake CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x9a33),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Tiger Lake PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa0a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Tiger Lake PCH-H */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x43a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Jasper Lake PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x4da6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Jasper Lake CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x4e29),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Elkhart Lake CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x4529),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Elkhart Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x4b26),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Emmitsburg PCH */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x1bcc),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Alder Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x7aa6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Alder Lake-P */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x51a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Alder Lake-M */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x54a6),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Meteor Lake-P */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x7e24),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Meteor Lake-S */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x7f26),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Meteor Lake-S CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xae24),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Raptor Lake-S */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x7a26),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Raptor Lake-S CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa76f),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Granite Rapids */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x0963),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Granite Rapids SOC */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x3256),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Sapphire Rapids SOC */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x3456),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Lunar Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xa824),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Arrow Lake */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x7724),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Panther Lake-H */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xe324),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Panther Lake-P/U */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0xe424),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Alder Lake CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x466f),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{
-		/* Rocket Lake CPU */
-		PCI_DEVICE(PCI_VENDOR_ID_INTEL, 0x4c19),
-		.driver_data = (kernel_ulong_t)&intel_th_2x,
-	},
-	{ 0 },
+	{ PCI_DEVICE_DATA(INTEL, NPK_CML,	&intel_th_2x) },   /* Comet Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_CML_PCH,	&intel_th_2x) },   /* Comet Lake PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_GNR,	&intel_th_2x) },   /* Granite Rapids */
+	{ PCI_DEVICE_DATA(INTEL, NPK_BXT,	NULL) },	   /* Broxton */
+	{ PCI_DEVICE_DATA(INTEL, NPK_CDF,	&intel_th_2x) },   /* Cedar Fork PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_DNV,	NULL) },	   /* Denverton */
+	{ PCI_DEVICE_DATA(INTEL, NPK_BXT_B,	NULL) },	   /* Broxton B-step */
+	{ PCI_DEVICE_DATA(INTEL, NPK_EBG,	&intel_th_2x) },   /* Emmitsburg PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_GLK,	&intel_th_2x) },   /* Gemini Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_GNR_SOC,	&intel_th_2x) },   /* Granite Rapids SOC */
+	{ PCI_DEVICE_DATA(INTEL, NPK_SPR,	&intel_th_2x) },   /* Sapphire Rapids SOC */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ICL_PCH,	&intel_th_2x) },   /* Ice Lake PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_TGL_PCH_H,	&intel_th_2x) },   /* Tiger Lake PCH-H */
+	{ PCI_DEVICE_DATA(INTEL, NPK_EHL_CPU,	&intel_th_2x) },   /* Elkhart Lake CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ICL_NNPI,	&intel_th_2x) },   /* Ice Lake NNPI */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ADL_CPU,	&intel_th_2x) },   /* Alder Lake CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_EHL,	&intel_th_2x) },   /* Elkhart Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_RKL,	&intel_th_2x) },   /* Rocket Lake CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_JSL_PCH,	&intel_th_2x) },   /* Jasper Lake PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_JSL_CPU,	&intel_th_2x) },   /* Jasper Lake CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ADL_P,	&intel_th_2x) },   /* Alder Lake-P */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ADL_M,	&intel_th_2x) },   /* Alder Lake-M */
+	{ PCI_DEVICE_DATA(INTEL, NPK_APL,	NULL) },	   /* Apollo Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ARL,	&intel_th_2x) },   /* Arrow Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_RPL_S,	&intel_th_2x) },   /* Raptor Lake-S */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ADL,	&intel_th_2x) },   /* Alder Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_MTL_P,	&intel_th_2x) },   /* Meteor Lake-P */
+	{ PCI_DEVICE_DATA(INTEL, NPK_MTL_S,	&intel_th_2x) },   /* Meteor Lake-S */
+	{ PCI_DEVICE_DATA(INTEL, NPK_ICL_CPU,	&intel_th_2x) },   /* Ice Lake CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_TGL_CPU,	&intel_th_2x) },   /* Tiger Lake CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_0,		NULL) },
+	{ PCI_DEVICE_DATA(INTEL, NPK_CNL_LP,	&intel_th_2x) },   /* Cannon Lake LP */
+	{ PCI_DEVICE_DATA(INTEL, NPK_TGL_PCH,	&intel_th_2x) },   /* Tiger Lake PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_1,		NULL) },
+	{ PCI_DEVICE_DATA(INTEL, NPK_LBG_PCH,	NULL) },	   /* Lewisburg PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_LBG_PCH_2,	NULL) },	   /* Lewisburg PCH */
+	{ PCI_DEVICE_DATA(INTEL, NPK_KBL_PCH,	&intel_th_1x_multi_is_broken) },   /* Kaby Lake PCH-H */
+	{ PCI_DEVICE_DATA(INTEL, NPK_CNL_H,	&intel_th_2x) },   /* Cannon Lake H */
+	{ PCI_DEVICE_DATA(INTEL, NPK_CML_PCH_V,	&intel_th_1x_multi_is_broken) },   /* Comet Lake PCH-V */
+	{ PCI_DEVICE_DATA(INTEL, NPK_RPL_S_CPU,	&intel_th_2x) },   /* Raptor Lake-S CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_LNL,	&intel_th_2x) },   /* Lunar Lake */
+	{ PCI_DEVICE_DATA(INTEL, NPK_MTL_S_CPU,	&intel_th_2x) },   /* Meteor Lake-S CPU */
+	{ PCI_DEVICE_DATA(INTEL, NPK_PTL_H,	&intel_th_2x) },   /* Panther Lake-H */
+	{ PCI_DEVICE_DATA(INTEL, NPK_PTL_PU,	&intel_th_2x) },   /* Panther Lake-P/U */
+	{ }
 };
 
 MODULE_DEVICE_TABLE(pci, intel_th_pci_id_table);
diff --git a/drivers/hwtracing/intel_th/pci_ids.h b/drivers/hwtracing/intel_th/pci_ids.h
new file mode 100644
index 000000000000..7dad5d7621f5
--- /dev/null
+++ b/drivers/hwtracing/intel_th/pci_ids.h
@@ -0,0 +1,56 @@
+/* SPDX-License-Identifier: GPL-2.0 */
+/*
+ * Intel(R) Trace Hub driver debugging
+ *
+ * Copyright (C) 2025 Intel Corporation.
+ */
+
+#ifndef __INTEL_TH_PCI_IDS_H__
+#define __INTEL_TH_PCI_IDS_H__
+
+#define PCI_DEVICE_ID_INTEL_NPK_CML	0x02a6
+#define PCI_DEVICE_ID_INTEL_NPK_CML_PCH	0x06a6
+#define PCI_DEVICE_ID_INTEL_NPK_GNR	0x0963
+#define PCI_DEVICE_ID_INTEL_NPK_BXT	0x0a80
+#define PCI_DEVICE_ID_INTEL_NPK_CDF	0x18e1
+#define PCI_DEVICE_ID_INTEL_NPK_DNV	0x19e1
+#define PCI_DEVICE_ID_INTEL_NPK_BXT_B	0x1a8e
+#define PCI_DEVICE_ID_INTEL_NPK_EBG	0x1bcc
+#define PCI_DEVICE_ID_INTEL_NPK_GLK	0x318e
+#define PCI_DEVICE_ID_INTEL_NPK_GNR_SOC	0x3256
+#define PCI_DEVICE_ID_INTEL_NPK_SPR	0x3456
+#define PCI_DEVICE_ID_INTEL_NPK_ICL_PCH	0x34a6
+#define PCI_DEVICE_ID_INTEL_NPK_TGL_PCH_H	0x43a6
+#define PCI_DEVICE_ID_INTEL_NPK_EHL_CPU	0x4529
+#define PCI_DEVICE_ID_INTEL_NPK_ICL_NNPI	0x45c5
+#define PCI_DEVICE_ID_INTEL_NPK_ADL_CPU	0x466f
+#define PCI_DEVICE_ID_INTEL_NPK_EHL	0x4b26
+#define PCI_DEVICE_ID_INTEL_NPK_RKL	0x4c19
+#define PCI_DEVICE_ID_INTEL_NPK_JSL_PCH	0x4da6
+#define PCI_DEVICE_ID_INTEL_NPK_JSL_CPU	0x4e29
+#define PCI_DEVICE_ID_INTEL_NPK_ADL_P	0x51a6
+#define PCI_DEVICE_ID_INTEL_NPK_ADL_M	0x54a6
+#define PCI_DEVICE_ID_INTEL_NPK_APL	0x5a8e
+#define PCI_DEVICE_ID_INTEL_NPK_ARL	0x7724
+#define PCI_DEVICE_ID_INTEL_NPK_RPL_S	0x7a26
+#define PCI_DEVICE_ID_INTEL_NPK_ADL	0x7aa6
+#define PCI_DEVICE_ID_INTEL_NPK_MTL_P	0x7e24
+#define PCI_DEVICE_ID_INTEL_NPK_MTL_S	0x7f26
+#define PCI_DEVICE_ID_INTEL_NPK_ICL_CPU	0x8a29
+#define PCI_DEVICE_ID_INTEL_NPK_TGL_CPU	0x9a33
+#define PCI_DEVICE_ID_INTEL_NPK_0	0x9d26
+#define PCI_DEVICE_ID_INTEL_NPK_CNL_LP	0x9da6
+#define PCI_DEVICE_ID_INTEL_NPK_TGL_PCH	0xa0a6
+#define PCI_DEVICE_ID_INTEL_NPK_1	0xa126
+#define PCI_DEVICE_ID_INTEL_NPK_LBG_PCH	0xa1a6
+#define PCI_DEVICE_ID_INTEL_NPK_LBG_PCH_2	0xa226
+#define PCI_DEVICE_ID_INTEL_NPK_KBL_PCH	0xa2a6
+#define PCI_DEVICE_ID_INTEL_NPK_CNL_H	0xa326
+#define PCI_DEVICE_ID_INTEL_NPK_CML_PCH_V	0xa3a6
+#define PCI_DEVICE_ID_INTEL_NPK_RPL_S_CPU	0xa76f
+#define PCI_DEVICE_ID_INTEL_NPK_LNL	0xa824
+#define PCI_DEVICE_ID_INTEL_NPK_MTL_S_CPU	0xae24
+#define PCI_DEVICE_ID_INTEL_NPK_PTL_H	0xe324
+#define PCI_DEVICE_ID_INTEL_NPK_PTL_PU	0xe424
+
+#endif /* __INTEL_TH_PCI_IDS_H__ */
-- 
2.53.0

