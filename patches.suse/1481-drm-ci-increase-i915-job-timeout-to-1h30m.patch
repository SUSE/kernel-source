From bce41257abce9f981c3a41f22a3b518ecaf83fe4 Mon Sep 17 00:00:00 2001
From: Helen Koike <helen.koike@collabora.com>
Date: Mon, 23 Oct 2023 21:45:22 -0300
Subject: drm/ci: increase i915 job timeout to 1h30m
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Git-commit: 5fa8f128462c5b3b20576b12286dca7fe95b3af1
Patch-mainline: v6.7-rc1
References: jsc#PED-9898 jsc#PED-10191 jsc#PED-10197 jsc#PED-10226 jsc#PED-10237 jsc#PED-10340 jsc#PED-10852 jsc#PED-11022 jsc#PED-3527 jsc#PED-5475 jsc#PED-6068 jsc#PED-6070 jsc#PED-6116 jsc#PED-6120 jsc#PED-5065 jsc#PED-5477 jsc#PED-5511 jsc#PED-6041 jsc#PED-6069 jsc#PED-6071

With the new sharding, the default job timeout is not enough for i915
and their jobs are failing before completing.

See below the current execution time:

ðŸž‹ job i915:tgl 8/8 has new status: success (37m3s)
ðŸž‹ job i915:tgl 7/8 has new status: success (19m43s)
ðŸž‹ job i915:tgl 6/8 has new status: success (21m47s)
ðŸž‹ job i915:tgl 5/8 has new status: success (18m16s)
ðŸž‹ job i915:tgl 4/8 has new status: success (21m43s)
ðŸž‹ job i915:tgl 3/8 has new status: success (17m59s)
ðŸž‹ job i915:tgl 2/8 has new status: success (22m15s)
ðŸž‹ job i915:tgl 1/8 has new status: success (18m52s)
ðŸž‹ job i915:cml 2/2 has new status: success (1h19m58s)
ðŸž‹ job i915:cml 1/2 has new status: success (55m45s)
ðŸž‹ job i915:whl 2/2 has new status: success (1h8m56s)
ðŸž‹ job i915:whl 1/2 has new status: success (54m3s)
ðŸž‹ job i915:kbl 3/3 has new status: success (37m43s)
ðŸž‹ job i915:kbl 2/3 has new status: success (36m37s)
ðŸž‹ job i915:kbl 1/3 has new status: success (34m52s)
ðŸž‹ job i915:amly 2/2 has new status: success (1h7m60s)
ðŸž‹ job i915:amly 1/2 has new status: success (59m18s)
ðŸž‹ job i915:glk 2/2 has new status: success (58m26s)
ðŸž‹ job i915:glk 1/2 has new status: success (50m23s)
ðŸž‹ job i915:apl 3/3 has new status: success (1h6m39s)
ðŸž‹ job i915:apl 2/3 has new status: success (1h4m45s)
ðŸž‹ job i915:apl 1/3 has new status: success (1h7m38s)

(generated with ci_run_n_monitor.py script)

The longest job is 1h19m58s, so adjust the timeout.

Signed-off-by: Helen Koike <helen.koike@collabora.com>
Link: https://lore.kernel.org/r/20231024004525.169002-8-helen.koike@collabora.com
Signed-off-by: Maxime Ripard <mripard@kernel.org>
Acked-by: Patrik Jakobsson <pjakobsson@suse.de>
---
 drivers/gpu/drm/ci/test.yml | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/drivers/gpu/drm/ci/test.yml b/drivers/gpu/drm/ci/test.yml
index 19dc0862e710..f285ed67eb3d 100644
--- a/drivers/gpu/drm/ci/test.yml
+++ b/drivers/gpu/drm/ci/test.yml
@@ -179,6 +179,7 @@ i915:apl:
   extends:
     - .i915
   parallel: 3
+  timeout: "1h30m"
   variables:
     DEVICE_TYPE: asus-C523NA-A20057-coral
     GPU_VERSION: apl
@@ -188,6 +189,7 @@ i915:glk:
   extends:
     - .i915
   parallel: 2
+  timeout: "1h30m"
   variables:
     DEVICE_TYPE: hp-x360-12b-ca0010nr-n4020-octopus
     GPU_VERSION: glk
@@ -197,6 +199,7 @@ i915:amly:
   extends:
     - .i915
   parallel: 2
+  timeout: "1h30m"
   variables:
     DEVICE_TYPE: asus-C433TA-AJ0005-rammus
     GPU_VERSION: amly
@@ -215,6 +218,7 @@ i915:whl:
   extends:
     - .i915
   parallel: 2
+  timeout: "1h30m"
   variables:
     DEVICE_TYPE: dell-latitude-5400-8665U-sarien
     GPU_VERSION: whl
@@ -224,6 +228,7 @@ i915:cml:
   extends:
     - .i915
   parallel: 2
+  timeout: "1h30m"
   variables:
     DEVICE_TYPE: asus-C436FA-Flip-hatch
     GPU_VERSION: cml
-- 
2.46.0

