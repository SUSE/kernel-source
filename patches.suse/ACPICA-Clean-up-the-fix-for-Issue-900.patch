From: Saket Dumbre <saket.dumbre@intel.com>
Date: Tue, 26 Dec 2023 13:32:56 -0800
Subject: ACPICA: Clean up the fix for Issue #900
Patch-mainline: v6.10-rc1
Git-commit: 5a02527783caae57535e0742262cd96b7167f983
References: jsc#PED-11164

ACPICA commit b6b38edb0c18017af0bd2aff4eaa502810c8873f

Link: https://github.com/acpica/acpica/commit/b6b38edb
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Acked-by: Chun-Yi Lee <jlee@suse.com>
---
 drivers/acpi/acpica/utdebug.c |    7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

--- a/drivers/acpi/acpica/utdebug.c
+++ b/drivers/acpi/acpica/utdebug.c
@@ -42,6 +42,7 @@ void acpi_ut_init_stack_ptr_trace(void)
 #pragma GCC diagnostic ignored "-Wdangling-pointer="
 #endif
 	acpi_gbl_entry_stack_pointer = &current_sp;
+#pragma GCC diagnostic pop
 }
 
 /*******************************************************************************
@@ -61,8 +62,12 @@ void acpi_ut_track_stack_ptr(void)
 	acpi_size current_sp;
 
 	if (&current_sp < acpi_gbl_lowest_stack_pointer) {
+#pragma GCC diagnostic push
+#if defined(__GNUC__) && __GNUC__ >= 12
+#pragma GCC diagnostic ignored "-Wdangling-pointer="
+#endif
 		acpi_gbl_lowest_stack_pointer = &current_sp;
-#pragma GCC diagnostic pop
+#pragma GCC diagnostic popmake
 	}
 
 	if (acpi_gbl_nesting_level > acpi_gbl_deepest_nesting) {
