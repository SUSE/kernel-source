From: Lukas Bulwahn <lukas.bulwahn@gmail.com>
Date: Tue, 15 Mar 2022 06:53:25 +0100
Subject: [PATCH] scsi: bsg: Drop needless assignment in scsi_bsg_sg_io_fn()
Git-commit: dc155e1acb18fe549bf4efc91ecca2a80deea5f2
Patch-mainline: v5.18-rc1
References: jsc#PED-1559

Commit ce70fd9a551a ("scsi: core: Remove the cmd field from struct
scsi_request") refactored scsi_bsg_sg_io_fn() so that it does not allocate
directly and hence does not return -ENOMEM in its error case.  That makes a
remaining assignment of -ENOMEM to the return variable needless.

Drop this needless assignment in scsi_bsg_sg_io_fn().

No functional change. No change in resulting object code.

Link: https://lore.kernel.org/r/20220315055325.14974-1-lukas.bulwahn@gmail.com
Reviewed-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Lukas Bulwahn <lukas.bulwahn@gmail.com>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
Acked-by: Hannes Reinecke <hare@suse.com>
---
 drivers/scsi/scsi_bsg.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/drivers/scsi/scsi_bsg.c b/drivers/scsi/scsi_bsg.c
index 8039c3c11a6e..96ee35256a16 100644
--- a/drivers/scsi/scsi_bsg.c
+++ b/drivers/scsi/scsi_bsg.c
@@ -31,7 +31,6 @@ static int scsi_bsg_sg_io_fn(struct request_queue *q, struct sg_io_v4 *hdr,
 		return PTR_ERR(rq);
 	rq->timeout = timeout;
 
-	ret = -ENOMEM;
 	scmd = blk_mq_rq_to_pdu(rq);
 	scmd->cmd_len = hdr->request_len;
 	if (scmd->cmd_len > sizeof(scmd->cmnd)) {
-- 
2.35.3

