From 96255b007099f9088b61aafd28ba9ff0d834f727 Mon Sep 17 00:00:00 2001
From: Patrik Jakobsson <pjakobsson@suse.de>
Date: Thu, 27 Jan 2022 16:25:55 +0100
Subject: [PATCH] drm: Add kabi placeholders to commonly used structs
Patch-mainline: Never, kABI padding
References: bsc#1179531

Signed-off-by: Patrik Jakobsson <pjakobsson@suse.de>
---
 include/drm/display/drm_dp_helper.h     | 2 ++
 include/drm/display/drm_dp_mst_helper.h | 2 ++
 include/drm/drm_atomic.h                | 2 ++
 include/drm/drm_connector.h             | 4 ++++
 include/drm/drm_crtc.h                  | 4 ++++
 include/drm/drm_device.h                | 2 ++
 include/drm/drm_gem.h                   | 2 ++
 include/drm/drm_mode_object.h           | 2 ++
 include/drm/drm_modes.h                 | 1 +
 include/drm/drm_plane.h                 | 4 ++++
 include/drm/ttm/ttm_device.h            | 2 ++
 11 files changed, 27 insertions(+)

diff --git a/include/drm/display/drm_dp_helper.h b/include/drm/display/drm_dp_helper.h
index 86f24a759268..0d8fb1beb460 100644
--- a/include/drm/display/drm_dp_helper.h
+++ b/include/drm/display/drm_dp_helper.h
@@ -449,6 +449,8 @@ struct drm_dp_aux {
 	 * @is_remote: Is this AUX CH actually using sideband messaging.
 	 */
 	bool is_remote;
+
+	void *suse_kabi_padding;
 };
 
 int drm_dp_dpcd_probe(struct drm_dp_aux *aux, unsigned int offset);
diff --git a/include/drm/display/drm_dp_mst_helper.h b/include/drm/display/drm_dp_mst_helper.h
index 8eeb6730ac6d..e80077b09294 100644
--- a/include/drm/display/drm_dp_mst_helper.h
+++ b/include/drm/display/drm_dp_mst_helper.h
@@ -798,6 +798,8 @@ struct drm_dp_mst_topology_mgr {
 	 */
 	struct mutex topology_ref_history_lock;
 #endif
+
+	void *suse_kabi_padding;
 };
 
 int drm_dp_mst_topology_mgr_init(struct drm_dp_mst_topology_mgr *mgr,
diff --git a/include/drm/drm_atomic.h b/include/drm/drm_atomic.h
index cf8e1220a4ac..06deaf092884 100644
--- a/include/drm/drm_atomic.h
+++ b/include/drm/drm_atomic.h
@@ -426,6 +426,8 @@ struct drm_atomic_state {
 	 * commit without blocking.
 	 */
 	struct work_struct commit_work;
+
+	void *suse_kabi_padding;
 };
 
 void __drm_crtc_commit_free(struct kref *kref);
diff --git a/include/drm/drm_connector.h b/include/drm/drm_connector.h
index 5a8115dca359..f3ab024d1516 100644
--- a/include/drm/drm_connector.h
+++ b/include/drm/drm_connector.h
@@ -1022,6 +1022,8 @@ struct drm_connector_state {
 	 * DRM blob property for HDR output metadata
 	 */
 	struct drm_property_blob *hdr_output_metadata;
+
+	void *suse_kabi_padding;
 };
 
 /**
@@ -1877,6 +1879,8 @@ struct drm_connector {
 
 	/** @hdr_sink_metadata: HDR Metadata Information read from sink */
 	struct hdr_sink_metadata hdr_sink_metadata;
+
+	void *suse_kabi_padding;
 };
 
 #define obj_to_connector(x) container_of(x, struct drm_connector, base)
diff --git a/include/drm/drm_crtc.h b/include/drm/drm_crtc.h
index 8b48a1974da3..d2f537daa581 100644
--- a/include/drm/drm_crtc.h
+++ b/include/drm/drm_crtc.h
@@ -385,6 +385,8 @@ struct drm_crtc_state {
 
 	/** @state: backpointer to global drm_atomic_state */
 	struct drm_atomic_state *state;
+
+	void *suse_kabi_padding;
 };
 
 /**
@@ -1175,6 +1177,8 @@ struct drm_crtc {
 	 * Initialized via drm_self_refresh_helper_init().
 	 */
 	struct drm_self_refresh_data *self_refresh_data;
+
+	void *suse_kabi_padding;
 };
 
 /**
diff --git a/include/drm/drm_device.h b/include/drm/drm_device.h
index 7cf4afae2e79..a5ebf5bbdcae 100644
--- a/include/drm/drm_device.h
+++ b/include/drm/drm_device.h
@@ -391,6 +391,8 @@ struct drm_device {
 	bool irq_enabled;
 	int irq;
 #endif
+
+	void *suse_kabi_padding;
 };
 
 #endif
diff --git a/include/drm/drm_gem.h b/include/drm/drm_gem.h
index bc9f6aa2f3fe..f9f50826b667 100644
--- a/include/drm/drm_gem.h
+++ b/include/drm/drm_gem.h
@@ -421,6 +421,8 @@ struct drm_gem_object {
 	 * The current LRU list that the GEM object is on.
 	 */
 	struct drm_gem_lru *lru;
+
+	void *suse_kabi_padding;
 };
 
 /**
diff --git a/include/drm/drm_mode_object.h b/include/drm/drm_mode_object.h
index 912f1e415685..48dd4e4c2be2 100644
--- a/include/drm/drm_mode_object.h
+++ b/include/drm/drm_mode_object.h
@@ -58,6 +58,8 @@ struct drm_mode_object {
 	struct drm_object_properties *properties;
 	struct kref refcount;
 	void (*free_cb)(struct kref *kref);
+
+	void *suse_kabi_padding;
 };
 
 #define DRM_OBJECT_MAX_PROPERTY 24
diff --git a/include/drm/drm_modes.h b/include/drm/drm_modes.h
index c613f0abe9dc..3a2cdc5598ff 100644
--- a/include/drm/drm_modes.h
+++ b/include/drm/drm_modes.h
@@ -417,6 +417,7 @@ struct drm_display_mode {
 	 */
 	enum hdmi_picture_aspect picture_aspect_ratio;
 
+	void *suse_kabi_padding;
 };
 
 /**
diff --git a/include/drm/drm_plane.h b/include/drm/drm_plane.h
index fef775200a81..54242d15b2de 100644
--- a/include/drm/drm_plane.h
+++ b/include/drm/drm_plane.h
@@ -247,6 +247,8 @@ struct drm_plane_state {
 
 	/** @state: backpointer to global drm_atomic_state */
 	struct drm_atomic_state *state;
+
+	void *suse_kabi_padding;
 };
 
 static inline struct drm_rect
@@ -758,6 +760,8 @@ struct drm_plane {
 	 * scaling.
 	 */
 	struct drm_property *scaling_filter_property;
+
+	void *suse_kabi_padding;
 };
 
 #define obj_to_plane(x) container_of(x, struct drm_plane, base)
diff --git a/include/drm/ttm/ttm_device.h b/include/drm/ttm/ttm_device.h
index c22f30535c84..5fb9c09045ce 100644
--- a/include/drm/ttm/ttm_device.h
+++ b/include/drm/ttm/ttm_device.h
@@ -266,6 +266,8 @@ struct ttm_device {
 	 * @wq: Work queue structure for the delayed delete workqueue.
 	 */
 	struct workqueue_struct *wq;
+
+	void *suse_kabi_padding;
 };
 
 int ttm_global_swapout(struct ttm_operation_ctx *ctx, gfp_t gfp_flags);
-- 
2.43.0

