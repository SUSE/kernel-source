From 16c211403998919682452ac323b71231efec7cce Mon Sep 17 00:00:00 2001
From: Gustavo Sousa <gustavo.sousa@intel.com>
Date: Fri, 21 Feb 2025 15:51:45 -0300
Subject: drm/xe: Re-use feature descriptors for pre-GMDID IPs
Git-commit: 16c211403998919682452ac323b71231efec7cce
Patch-mainline: v6.15-rc1
References: jsc#PED-13979 jsc#PED-14039 jsc#PED-14046 jsc#PED-14211 jsc#PED-14333 jsc#PED-14487 jsc#PED-14488 jsc#PED-14497 jsc#PED-14499

Now that pre-GMDID IPs are described via struct xe_ip, it is possible to
re-use the feature descriptors that have exact match with ones from
previous releases. Do that.

Signed-off-by: Gustavo Sousa <gustavo.sousa@intel.com>
Reviewed-by: Matt Roper <matthew.d.roper@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20250221-xe-unify-ip-descriptors-v2-6-5bc0c6d0c13f@intel.com
Signed-off-by: Matt Roper <matthew.d.roper@intel.com>
Acked-by: Patrik Jakobsson <pjakobsson@suse.de>

---
 drivers/gpu/drm/xe/xe_pci.c | 17 ++---------------
 1 file changed, 2 insertions(+), 15 deletions(-)

diff --git a/drivers/gpu/drm/xe/xe_pci.c b/drivers/gpu/drm/xe/xe_pci.c
index bcc953a6c672..be61a073f711 100644
--- a/drivers/gpu/drm/xe/xe_pci.c
+++ b/drivers/gpu/drm/xe/xe_pci.c
@@ -88,13 +88,6 @@ static const struct xe_graphics_desc graphics_xelp = {
 	.vm_max_level = 3,
 };
 
-static const struct xe_graphics_desc graphics_xelpp = {
-	.hw_engine_mask = BIT(XE_HW_ENGINE_RCS0) | BIT(XE_HW_ENGINE_BCS0),
-
-	.va_bits = 48,
-	.vm_max_level = 3,
-};
-
 #define XE_HP_FEATURES \
 	.has_range_tlb_invalidation = true, \
 	.va_bits = 48, \
@@ -164,12 +157,6 @@ static const struct xe_media_desc media_xem = {
 		GENMASK(XE_HW_ENGINE_VECS3, XE_HW_ENGINE_VECS0),
 };
 
-static const struct xe_media_desc media_xehpm = {
-	.hw_engine_mask =
-		GENMASK(XE_HW_ENGINE_VCS7, XE_HW_ENGINE_VCS0) |
-		GENMASK(XE_HW_ENGINE_VECS3, XE_HW_ENGINE_VECS0),
-};
-
 static const struct xe_media_desc media_xelpmp = {
 	.hw_engine_mask =
 		GENMASK(XE_HW_ENGINE_VCS7, XE_HW_ENGINE_VCS0) |
@@ -179,7 +166,7 @@ static const struct xe_media_desc media_xelpmp = {
 
 /* Pre-GMDID Graphics IPs */
 static const struct xe_ip graphics_ip_xelp = { 1200, "Xe_LP", &graphics_xelp };
-static const struct xe_ip graphics_ip_xelpp = { 1210, "Xe_LP+", &graphics_xelpp };
+static const struct xe_ip graphics_ip_xelpp = { 1210, "Xe_LP+", &graphics_xelp };
 static const struct xe_ip graphics_ip_xehpg = { 1255, "Xe_HPG", &graphics_xehpg };
 static const struct xe_ip graphics_ip_xehpc = { 1260, "Xe_HPC", &graphics_xehpc };
 
@@ -196,7 +183,7 @@ static const struct xe_ip graphics_ips[] = {
 
 /* Pre-GMDID Media IPs */
 static const struct xe_ip media_ip_xem = { 1200, "Xe_M", &media_xem };
-static const struct xe_ip media_ip_xehpm = { 1255, "Xe_HPM", &media_xehpm };
+static const struct xe_ip media_ip_xehpm = { 1255, "Xe_HPM", &media_xem };
 
 /* GMDID-based Media IPs */
 static const struct xe_ip media_ips[] = {
-- 
2.52.0

