From: Zicheng Qu <quzicheng@huawei.com>
Date: Fri, 1 Nov 2024 09:13:24 +0000
Subject: padata: Clean up in padata_do_multithreaded()
Git-commit: e45f0ab6ee48531f8bd4cae94a498893a983a5e1
Patch-mainline: v6.13-rc1
References: bsc#1237563

In commit 24cc57d8faaa ("padata: Honor the caller's alignment in case of
chunk_size 0"), the line 'ps.chunk_size = max(ps.chunk_size, 1ul)' was
added, making 'ps.chunk_size = 1U' redundant and never executed.

Signed-off-by: Zicheng Qu <quzicheng@huawei.com>
Acked-by: Daniel Jordan <daniel.m.jordan@oracle.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Acked-by: Michal Koutn√Ω <mkoutny@suse.com>
---
 kernel/padata.c |    7 -------
 1 file changed, 7 deletions(-)

--- a/kernel/padata.c
+++ b/kernel/padata.c
@@ -520,13 +520,6 @@ void __init padata_do_multithreaded(stru
 	ps.chunk_size = max(ps.chunk_size, 1ul);
 	ps.chunk_size = roundup(ps.chunk_size, job->align);
 
-	/*
-	 * chunk_size can be 0 if the caller sets min_chunk to 0. So force it
-	 * to at least 1 to prevent divide-by-0 panic in padata_mt_helper().`
-	 */
-	if (!ps.chunk_size)
-		ps.chunk_size = 1U;
-
 	list_for_each_entry(pw, &works, pw_list)
 		queue_work(system_unbound_wq, &pw->pw_work);
 
