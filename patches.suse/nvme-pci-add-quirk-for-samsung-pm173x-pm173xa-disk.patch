From: Daniel Wagner <dwagner@suse.de>
Date: Fri, 24 May 2024 10:41:08 +0200
Subject: nvme-pci: add quirk for Samsung PM173x/PM173xa disk
Patch-mainline: Never, upstream NAKed 
References: bsc#1241148

Some PM173x reports some non unique ids. Enable the relaxed ID check
quirk for this drive:

  nvme4n1 samsung S5L7NE0N705766
     nguid   : 354c37304e7057660025384500000001
     eui64   : 00253897010116a1

     nvme4n2
     nguid   : 354c37304e7057660025384500000002
     eui64   : 00253897010116a1

     nvme4n3
     nguid   : 354c37304e7057660025384500000003
     eui64   : 00253897010116a1

Signed-off-by: Daniel Wagner <dwagner@suse.de>
---
 drivers/nvme/host/pci.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/nvme/host/pci.c b/drivers/nvme/host/pci.c
index b3bec6ed1d79..1c30640d06be 100644
--- a/drivers/nvme/host/pci.c
+++ b/drivers/nvme/host/pci.c
@@ -3527,6 +3527,10 @@ static const struct pci_device_id nvme_id_table[] = {
 		.driver_data = NVME_QUIRK_DISABLE_WRITE_ZEROES, },
 	{ PCI_DEVICE(0x144d, 0xa802),   /* Samsung SM953 */
 		.driver_data = NVME_QUIRK_BOGUS_NID, },
+	{ PCI_DEVICE(0x144d, 0xa824),   /* Samsung PM173X */
+		.driver_data = NVME_QUIRK_PARTIAL_NID, },
+	{ PCI_DEVICE(0x144d, 0xa825),   /* Samsung PM173Xa */
+		.driver_data = NVME_QUIRK_PARTIAL_NID, },
 	{ PCI_DEVICE(0x1cc4, 0x6303),   /* UMIS RPJTJ512MGE1QDY 512G */
 		.driver_data = NVME_QUIRK_DISABLE_WRITE_ZEROES, },
 	{ PCI_DEVICE(0x1cc4, 0x6302),   /* UMIS RPJTJ256MGE1QDY 256G */
-- 
2.35.3

