From 04762bf177749ee946ccdc2f90667bdffe371272 Mon Sep 17 00:00:00 2001
From: Sean Young <sean@mess.org>
Date: Wed, 2 Oct 2024 19:17:47 +0100
Subject: [PATCH] media: gpio-ir-tx: Remove redundant call to
 local_irq_disable()

References: bsc#1232534 (PREEMPT_RT prerequisite backports)
Git-commit: 4738cae3ce671d9275aa543ac42eb716d90df7ca
Patch-mainline: v6.13-rc1

local_irq_save() already disables interrupts.

Link: https://lore.kernel.org/all/20241002134843.rFHJYxSI@linutronix.de/
Suggested-by: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Mel Gorman <mgorman@suse.de>
---
 drivers/media/rc/gpio-ir-tx.c | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/drivers/media/rc/gpio-ir-tx.c b/drivers/media/rc/gpio-ir-tx.c
index 2b829c146db1..f659188ec2a9 100644
--- a/drivers/media/rc/gpio-ir-tx.c
+++ b/drivers/media/rc/gpio-ir-tx.c
@@ -78,8 +78,6 @@ static void gpio_ir_tx_unmodulated(struct gpio_ir *gpio_ir, uint *txbuf,
 	ktime_t edge;
 	int i;
 
-	local_irq_disable();
-
 	edge = ktime_get();
 
 	for (i = 0; i < count; i++) {
@@ -110,8 +108,6 @@ static void gpio_ir_tx_modulated(struct gpio_ir *gpio_ir, uint *txbuf,
 	space = DIV_ROUND_CLOSEST((100 - gpio_ir->duty_cycle) *
 				  (NSEC_PER_SEC / 100), gpio_ir->carrier);
 
-	local_irq_disable();
-
 	edge = ktime_get();
 
 	for (i = 0; i < count; i++) {
