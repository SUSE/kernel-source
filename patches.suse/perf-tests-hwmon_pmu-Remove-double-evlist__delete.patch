From: Arnaldo Carvalho de Melo <acme@kernel.org>
Date: Tue, 19 Nov 2024 16:34:31 -0300
Subject: perf tests hwmon_pmu: Remove double evlist__delete()
Git-commit: 870748fa1fac5a397c26126bc32662e9249762c7
Patch-mainline: v6.13-rc1
References: perf-sle16-v6.13-userspace-update

In the error path when failing to parse events the evlist is being
deleted twice, keep the one after the out label.

Fixes: 531ee0fd4836994f ("perf test: Add hwmon "PMU" test")
Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
Link: https://lore.kernel.org/r/ZzzoJNNcJJVnPCCe@x1
Signed-off-by: Namhyung Kim <namhyung@kernel.org>
Signed-off-by: Tony Jones <tonyj@suse.de>
---
 tools/perf/tests/hwmon_pmu.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/tools/perf/tests/hwmon_pmu.c b/tools/perf/tests/hwmon_pmu.c
index 1e5f93aaaf5f..d8ed00d45dd7 100644
--- a/tools/perf/tests/hwmon_pmu.c
+++ b/tools/perf/tests/hwmon_pmu.c
@@ -155,8 +155,6 @@ static int do_test(size_t i, bool with_pmu, bool with_alias)
 	parse_events_error__init(&err);
 	ret = parse_events(evlist, str, &err);
 	if (ret) {
-		evlist__delete(evlist);
-
 		pr_debug("FAILED %s:%d failed to parse event '%s', err %d\n",
 			 __FILE__, __LINE__, str, ret);
 		parse_events_error__print(&err, str);

