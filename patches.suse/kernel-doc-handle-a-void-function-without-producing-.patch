From afa751e84c30b517aebd418970d222c39c81acb8 Mon Sep 17 00:00:00 2001
From: Randy Dunlap <rdunlap@infradead.org>
Date: Mon, 25 Dec 2023 22:52:19 -0800
Subject: [PATCH] kernel-doc: handle a void function without producing a warning
Git-commit: afa751e84c30b517aebd418970d222c39c81acb8
Patch-mainline: v6.8-rc1
References: git-fixes

Currently a void function can produce a warning:
  main.c:469: warning: contents before sections

This one is from arch/x86/kernel/cpu/sgx/main.c (which is not included
in any produced kernel documentation output).

Handle this by setting $in_doc_sect to 1 whenever any recognized
document section name is processed.

Fixes: f624adef3d0b ("kernel-doc: limit the "section header:" detection to a select few")
Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
Cc: Jani Nikula <jani.nikula@intel.com>
Cc: Jonathan Corbet <corbet@lwn.net>
Cc: linux-doc@vger.kernel.org
Signed-off-by: Jonathan Corbet <corbet@lwn.net>
Link: https://lore.kernel.org/r/20231226065219.319-1-rdunlap@infradead.org
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 scripts/kernel-doc | 1 +
 1 file changed, 1 insertion(+)

diff --git a/scripts/kernel-doc b/scripts/kernel-doc
index 3cdc7dba37e3..3ecdab5ca612 100755
--- a/scripts/kernel-doc
+++ b/scripts/kernel-doc
@@ -2121,6 +2121,7 @@ sub process_body($$) {
     }
 
     if (/$doc_sect/i) { # case insensitive for supported section names
+	$in_doc_sect = 1;
 	$newsection = $1;
 	$newcontents = $2;
 
-- 
2.35.3

