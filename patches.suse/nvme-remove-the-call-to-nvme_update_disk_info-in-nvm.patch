From: Christoph Hellwig <hch@lst.de>
Date: Tue, 14 Sep 2021 09:06:57 +0200
Subject: nvme: remove the call to nvme_update_disk_info in nvme_ns_remove
Patch-mainline: v5.15-rc2
Git-commit: 9da4c7276ec5d167972d8f6670d64b59838b4ed2
References: jsc#PED-1183

There is no need to explicitly unregister the integrity profile when
deleting the gendisk.

Signed-off-by: Christoph Hellwig <hch@lst.de>
Reviewed-by: Sagi Grimberg <sagi@grimberg.me>
Link: https://lore.kernel.org/r/20210914070657.87677-4-hch@lst.de
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Acked-by: Daniel Wagner <dwagner@suse.de>
---
 drivers/nvme/host/core.c |    2 --
 1 file changed, 2 deletions(-)

--- a/drivers/nvme/host/core.c
+++ b/drivers/nvme/host/core.c
@@ -3856,8 +3856,6 @@ static void nvme_ns_remove(struct nvme_n
 		nvme_cdev_del(&ns->cdev, &ns->cdev_device);
 	del_gendisk(ns->disk);
 	blk_cleanup_queue(ns->queue);
-	if (blk_get_integrity(ns->disk))
-		blk_integrity_unregister(ns->disk);
 
 	down_write(&ns->ctrl->namespaces_rwsem);
 	list_del_init(&ns->list);
