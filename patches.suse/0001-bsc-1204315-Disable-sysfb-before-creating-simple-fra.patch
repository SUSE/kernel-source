From 49bd201996152822e3f5f9aa3a7f8da3518a7b42 Mon Sep 17 00:00:00 2001
From: Thomas Zimmermann <tzimmermann@suse.de>
Date: Thu, 10 Nov 2022 09:27:41 +0100
Subject: [PATCH] bsc#1204315: Disable sysfb before creating simple-framebuffer
 from DT
Patch-mainline: Never, internal workaround
References: bsc#1204315

Otherwise sysfb will create a second platform device for the same
framebuffer. Avoids warning about duplicate resource usage.

Signed-off-by: Thomas Zimmermann <tzimmermann@suse.de>
Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
---
 drivers/of/platform.c |    1 +
 1 file changed, 1 insertion(+)

--- a/drivers/of/platform.c
+++ b/drivers/of/platform.c
@@ -574,6 +574,7 @@ static int __init of_platform_default_po
 			of_node_put(node);
 		}
 
+		sysfb_disable(NULL);
 		node = of_get_compatible_child(of_chosen, "simple-framebuffer");
 		if (node) {
 			/*
