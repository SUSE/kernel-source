From 14afdd6ee3a0db7bcae887d1951ed21c4d1539cd Mon Sep 17 00:00:00 2001
From: Hao Xu <haoxu@linux.alibaba.com>
Date: Fri, 27 Aug 2021 17:46:08 +0800
Subject: [PATCH] io_uring: remove redundant req_set_fail()
Git-commit: 14afdd6ee3a0db7bcae887d1951ed21c4d1539cd
Patch-mainline: v5.15-rc1
References: bsc#1205205

req_set_fail() in io_submit_sqe() is redundant, remove it.

Signed-off-by: Hao Xu <haoxu@linux.alibaba.com>
Reviewed-by: Pavel Begunkov <asml.silence@gmail.com>
Link: https://lore.kernel.org/r/20210827094609.36052-2-haoxu@linux.alibaba.com
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
---
 fs/io_uring.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/fs/io_uring.c b/fs/io_uring.c
index be3c3aea6398..48cc6328eb06 100644
--- a/fs/io_uring.c
+++ b/fs/io_uring.c
@@ -6734,7 +6734,6 @@ static int io_submit_sqe(struct io_ring_ctx *ctx, struct io_kiocb *req,
 fail_req:
 		if (link->head) {
 			/* fail even hard links since we don't submit */
-			req_set_fail(link->head);
 			io_req_complete_failed(link->head, -ECANCELED);
 			link->head = NULL;
 		}
-- 
2.35.3

