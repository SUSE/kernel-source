From: Takashi Iwai <tiwai@suse.de>
Subject: iwlwifi: Fix MODULE_FIRMWARE() for non-existing ucode version
Patch-mainline: Never, temporary workaround
References: boo#1191417

iwlwifi driver declares the requested firmware *-72.ucode for 22000
series, but that version isn't found in the upstream linux-firmware
tree.  As a result, the installation image (and initrd) misses the
requested firmware, which leads to the non-working WiFi.

As a temporary fix, correct the ucode version to the existing one,
*-71.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/net/wireless/intel/iwlwifi/cfg/22000.c |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

--- a/drivers/net/wireless/intel/iwlwifi/cfg/22000.c
+++ b/drivers/net/wireless/intel/iwlwifi/cfg/22000.c
@@ -10,7 +10,11 @@
 #include "fw/api/txq.h"
 
 /* Highest firmware API version supported */
-#define IWL_22000_UCODE_API_MAX	72
+/* FIXME: Intel never released *-72.ucode but only *-71.ucode (as of 2022 Aug).
+ *        For fixing a spurious kernel error and initrd creation,
+ *        set to 71 instead of non-existing 72
+ */
+#define IWL_22000_UCODE_API_MAX	71
 
 /* Lowest firmware API version supported */
 #define IWL_22000_UCODE_API_MIN	39
