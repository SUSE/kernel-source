From: Martin Habets <habetsm.xilinx@gmail.com>
Date: Thu, 19 May 2022 08:17:15 +0100
Subject: sfc/siena: Remove duplicate check on segments
Patch-mainline: v5.19-rc1
Git-commit: cc398a34d16fd90a2dcc59b1105c634f038ea53b
References: jsc#PED-1565

Siena only supports software TSO. This means more code can be deleted,
as pointed out by the Smatch static checker warning:
	drivers/net/ethernet/sfc/siena/tx.c:184 __efx_siena_enqueue_skb()
	warn: duplicate check 'segments' (previous on line 158)

Fixes: 956f2d86cb37 ("sfc/siena: Remove build references to missing functionality")
Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: https://lore.kernel.org/kernel-janitors/YoH5tJMnwuGTrn1Z@kili/
Signed-off-by: Martin Habets <habetsm.xilinx@gmail.com>
Link: https://lore.kernel.org/r/165294463549.23865.4557617334650441347.stgit@palantir17.mph.net
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/ethernet/sfc/siena/tx.c |    9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

--- a/drivers/net/ethernet/sfc/siena/tx.c
+++ b/drivers/net/ethernet/sfc/siena/tx.c
@@ -181,14 +181,7 @@ netdev_tx_t __efx_siena_enqueue_skb(stru
 	if (__netdev_tx_sent_queue(tx_queue->core_txq, skb_len, xmit_more))
 		efx_tx_send_pending(tx_queue->channel);
 
-	if (segments) {
-		tx_queue->tso_bursts++;
-		tx_queue->tso_packets += segments;
-		tx_queue->tx_packets  += segments;
-	} else {
-		tx_queue->tx_packets++;
-	}
-
+	tx_queue->tx_packets++;
 	return NETDEV_TX_OK;
 
 
