From: Tedd Ho-Jeong An <tedd.an@intel.com>
Date: Mon, 4 Oct 2021 10:01:26 -0700
Subject: Bluetooth: hci_vhci: Fix to set the force_wakeup value
Patch-mainline: v5.17-rc1
Git-commit: 8b89637dbac2d73d9f3dadf91b4a7dcdb1fc23af
References: jsc#PED-1407

This patch sets the wakeup state of the vhci driver when the
force_wakeup is updated.

Fixes: 60edfad4fd0b6 ("Bluetooth: hci_vhci: Add force_prevent_wake entry")
Signed-off-by: Tedd Ho-Jeong An <tedd.an@intel.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
Acked-by: Lee, Chun-Yi <jlee@suse.com>
---
 drivers/bluetooth/hci_vhci.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/drivers/bluetooth/hci_vhci.c
+++ b/drivers/bluetooth/hci_vhci.c
@@ -182,6 +182,8 @@ static ssize_t force_wakeup_write(struct
 	if (data->wakeup == enable)
 		return -EALREADY;
 
+	data->wakeup = enable;
+
 	return count;
 }
 
