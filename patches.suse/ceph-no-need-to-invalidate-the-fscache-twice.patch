From: Xiubo Li <xiubli@redhat.com>
Date: Thu, 7 Apr 2022 13:12:42 +0800
Subject: ceph: no need to invalidate the fscache twice
Git-commit: 68e5ec2ec94576bee4d5280d512ed47e6f876baf
Patch-mainline: v5.19-rc1
References: jsc#SES-1880

Fixes: 400e1286c0ec3 ("ceph: conversion to new fscache API")
Signed-off-by: Xiubo Li <xiubli@redhat.com>
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Ilya Dryomov <idryomov@gmail.com>
Acked-by: Luis Henriques <lhenriques@suse.com>
---
 fs/ceph/inode.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/fs/ceph/inode.c b/fs/ceph/inode.c
index f9b68b2c9b12..e6065483c36b 100644
--- a/fs/ceph/inode.c
+++ b/fs/ceph/inode.c
@@ -1886,7 +1886,6 @@ static void ceph_do_invalidate_pages(struct inode *inode)
 	orig_gen = ci->i_rdcache_gen;
 	spin_unlock(&ci->i_ceph_lock);
 
-	ceph_fscache_invalidate(inode, false);
 	if (invalidate_inode_pages2(inode->i_mapping) < 0) {
 		pr_err("invalidate_inode_pages2 %llx.%llx failed\n",
 		       ceph_vinop(inode));

