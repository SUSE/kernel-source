From: Steve French <stfrench@microsoft.com>
Date: Mon, 19 Jun 2023 20:45:33 -0500
Subject: [PATCH] cifs: print more detail when invalidate_inode_mapping fails
Git-commit: acf35d79ee8c1cce0f879efe6446cf81e5491c36
References: bsc#1193629
Patch-mainline: v6.4

We had seen cases where cifs_invalidate_mapping was logging:
   "Could not invalidate inode ..."
if invalidate_inode_pages2 fails but this message does not show what
the rc is.  Update the logged message to also log the return code.

Suggested-by: Shyam Prasad N <sprasad@microsoft.com>
Reviewed-by: Shyam Prasad N <sprasad@microsoft.com>
Signed-off-by: Steve French <stfrench@microsoft.com>
Acked-by: Paulo Alcantara <palcantara@suse.de>
---
 fs/smb/client/inode.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/fs/smb/client/inode.c
+++ b/fs/smb/client/inode.c
@@ -2342,8 +2342,8 @@ cifs_invalidate_mapping(struct inode *in
 	if (inode->i_mapping && inode->i_mapping->nrpages != 0) {
 		rc = invalidate_inode_pages2(inode->i_mapping);
 		if (rc)
-			cifs_dbg(VFS, "%s: Could not invalidate inode %p\n",
-				 __func__, inode);
+			cifs_dbg(VFS, "%s: invalidate inode %p failed with rc %d\n",
+				 __func__, inode, rc);
 	}
 
 	cifs_fscache_fill_coherency(&cifsi->vfs_inode, &cd);
