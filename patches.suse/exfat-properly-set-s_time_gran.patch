From 674a9985b8e35288225f2b67829a7dee3bf761da Mon Sep 17 00:00:00 2001
From: Eric Sandeen <sandeen@sandeen.net>
Date: Fri Apr 17 14:43:49 2020 +0900
Subject: [PATCH] exfat: properly set s_time_gran 
Git-commit: 674a9985b8e35288225f2b67829a7dee3bf761da
References: bsc#1192328
Patch-mainline: v5.7-rc3


The s_time_gran superblock field indicates the on-disk nanosecond
granularity of timestamps, and for exfat that seems to be 10ms, so
set s_time_gran to 10000000ns. Without this, in-memory timestamps
change when they get re-read from disk.

Signed-off-by: Eric Sandeen <sandeen@sandeen.net>
Signed-off-by: Namjae Jeon <namjae.jeon@samsung.com>
Acked-by: Goldwyn Rodrigues <rgoldwyn@suse.com>

---
 fs/exfat/super.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/fs/exfat/super.c
+++ b/fs/exfat/super.c
@@ -547,7 +547,7 @@
 	sb->s_magic = EXFAT_SUPER_MAGIC;
 	sb->s_op = &exfat_sops;
 
-	sb->s_time_gran = 1;
+	sb->s_time_gran = 10 * NSEC_PER_MSEC;
 
 	err = __exfat_fill_super(sb);
 	if (err) {
