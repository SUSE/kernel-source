From: Nicolai Stange <nstange@suse.de>
Date: Mon, 31 Jan 2022 16:15:41 +0100
Subject: [PATCH] crypto: testmgr - disallow plain cbcmac(aes) in FIPS mode
References: jsc#SLE-21132,bsc#1194774
Patch-mainline: Not yet, to be posted soon once prerequisites have landed

cbcmac(aes) may be used only as part of the ccm(aes) construction in FIPS
mode. Mark plain cbcmac(aes) as non-approved in testmgr.

Signed-off-by: Nicolai Stange <nstange@suse.de>
---
 crypto/testmgr.c |    1 -
 1 file changed, 1 deletion(-)

--- a/crypto/testmgr.c
+++ b/crypto/testmgr.c
@@ -4439,7 +4439,6 @@ static const struct alg_test_desc alg_te
 	}, {
 #endif
 		.alg = "cbcmac(aes)",
-		.fips_allowed = 1,
 		.test = alg_test_hash,
 		.suite = {
 			.hash = __VECS(aes_cbcmac_tv_template)
