From 2c3bc137f1e339c4fa9485ec4028433b8cb7374b Mon Sep 17 00:00:00 2001
From: Heiko Carstens <hca@linux.ibm.com>
Date: Tue, 26 Nov 2024 14:28:24 +0100
Subject: [PATCH] s390/spinlock: Remove condition code clobber from
 arch_spin_unlock()
Git-commit: 2c3bc137f1e339c4fa9485ec4028433b8cb7374b
Patch-mainline: v6.13-rc1
References: bsc#1257818

Both instructions in arch_spin_unlock() do not clobber the condition
code. Therefore remove the condition code clobber from the inline assembly.

Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
Signed-off-by: Jiri Wiesner <jwiesner@suse.de>
---
 arch/s390/include/asm/spinlock.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/s390/include/asm/spinlock.h b/arch/s390/include/asm/spinlock.h
index f2722775baf6..9601e27d3291 100644
--- a/arch/s390/include/asm/spinlock.h
+++ b/arch/s390/include/asm/spinlock.h
@@ -85,7 +85,7 @@ static inline void arch_spin_unlock(arch_spinlock_t *lp)
 		"	sth	%[zero],%[lock]\n"
 		: [lock] "=R" (((unsigned short *)&lp->lock)[1])
 		: [zero] "d" (0)
-		: "cc", "memory");
+		: "memory");
 }
 
 /*
-- 
2.51.0

