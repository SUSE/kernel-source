From: Halil Pasic <pasic@linux.ibm.com>
Date: Mon, 23 Aug 2021 15:34:58 +0200
Subject: [PATCH] scsi: core: scsi_ioctl: Fix error code propagation in SG_IO
Git-commit: 04a71cdc46a94b13ee876290ad961b4886e24c76
Patch-mainline: v5.15-rc1
References: jsc#PED-1559

Link: https://lore.kernel.org/r/20210823133458.3536824-1-pasic@linux.ibm.com
Fixes: f2542a3be327 ("scsi: scsi_ioctl: Move the "block layer" SCSI ioctl handling to drivers/scsi")
Reviewed-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
Acked-by: Hannes Reinecke <hare@suse.com>
---
 drivers/scsi/scsi_ioctl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/scsi/scsi_ioctl.c b/drivers/scsi/scsi_ioctl.c
index 7b2b0a1581f4..6ff2207bd45a 100644
--- a/drivers/scsi/scsi_ioctl.c
+++ b/drivers/scsi/scsi_ioctl.c
@@ -874,7 +874,7 @@ static int scsi_ioctl_sg_io(struct scsi_device *sdev, struct gendisk *disk,
 		return error;
 	if (put_sg_io_hdr(&hdr, argp))
 		return -EFAULT;
-	return 0;
+	return error;
 }
 
 /**
-- 
2.35.3

