From 7cacc011a9c78b915ad91fdfe854646f868bed06 Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.com>
Date: Wed, 28 Feb 2024 13:15:50 +0100
Subject: [PATCH 5/5] new paddings for the new features of TB
Patch-mainline: Never, kabi padding
References: bsc#1220369

New data structures added for new features.
They need to be covered.

Signed-off-by: Oliver Neukum <oneukum@suse.com>
---
 drivers/thunderbolt/tb.h     | 8 ++++++++
 drivers/thunderbolt/tunnel.h | 1 +
 2 files changed, 9 insertions(+)

diff --git a/drivers/thunderbolt/tb.h b/drivers/thunderbolt/tb.h
index 7a8814bd3..c318d7c4d 100644
--- a/drivers/thunderbolt/tb.h
+++ b/drivers/thunderbolt/tb.h
@@ -60,6 +60,7 @@ struct tb_nvm {
 	bool authenticating;
 	bool flushed;
 	const struct tb_nvm_vendor_ops *vops;
+	void *suse_kabi_padding;
 };
 
 enum tb_nvm_write_ops {
@@ -210,6 +211,7 @@ struct tb_switch {
 	unsigned int max_pcie_credits;
 	unsigned int max_dma_credits;
 	unsigned int clx;
+	void *suse_kabi_padding;
 };
 
 /**
@@ -286,6 +288,7 @@ struct tb_port {
 	struct tb_bandwidth_group *group;
 	struct list_head group_list;
 	unsigned int max_bw;
+	void *suse_kabi_padding;
 };
 
 /**
@@ -302,6 +305,7 @@ struct usb4_port {
 	struct tb_port *port;
 	bool can_offline;
 	bool offline;
+	void *suse_kabi_padding;
 #ifdef CONFIG_USB4_DEBUGFS_MARGINING
 	struct tb_margining *margining;
 #endif
@@ -329,6 +333,7 @@ struct tb_retimer {
 	struct tb_nvm *nvm;
 	bool no_nvm_upgrade;
 	u32 auth_status;
+	void *suse_kabi_padding;
 };
 
 /**
@@ -366,6 +371,7 @@ struct tb_path_hop {
 	int next_hop_index;
 	unsigned int initial_credits;
 	unsigned int nfc_credits;
+	void *suse_kabi_padding;
 	bool pm_support;
 };
 
@@ -423,6 +429,7 @@ struct tb_path {
 	struct tb_path_hop *hops;
 	int path_length;
 	bool alloc_hopid;
+	void *suse_kabi_padding;
 };
 
 /* HopIDs 0-7 are reserved by the Thunderbolt protocol */
@@ -516,6 +523,7 @@ struct tb_cm_ops {
 			      void *rx_data, size_t rx_data_len);
 	int (*usb4_switch_nvm_authenticate_status)(struct tb_switch *sw,
 						   u32 *status);
+	void *suse_kabi_padding;
 };
 
 static inline void *tb_priv(struct tb *tb)
diff --git a/drivers/thunderbolt/tunnel.h b/drivers/thunderbolt/tunnel.h
index e651b541e..ad76dec66 100644
--- a/drivers/thunderbolt/tunnel.h
+++ b/drivers/thunderbolt/tunnel.h
@@ -67,6 +67,7 @@ struct tb_tunnel {
 	void (*reclaim_available_bandwidth)(struct tb_tunnel *tunnel,
 					    int *available_up,
 					    int *available_down);
+	void *suse_kabi_padding_methods;
 	struct list_head list;
 	enum tb_tunnel_type type;
 	int max_up;
-- 
2.43.2

