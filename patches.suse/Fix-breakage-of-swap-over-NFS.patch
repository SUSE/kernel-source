From: NeilBrown <neilb@suse.com>
Subject: Fix breakage of swap over NFS
References: bsc#1188924
Patch-mainline: Not yet, who knows what mainline will do

  patches.suse/vfs-dont-allow-writes-to-swap-files.patch

break swap-over-NFS which uses directo writes to write to
swap files.

I believe it is not appropriate to forbid writing to swap files.
Permissions can ensure that only root can write, and root needs to be
careful anyway.

So remove these two lines to allow swap-over-NFS to work

Signed-off-by: NeilBrown <neilb@suse.de>

---
 mm/filemap.c |    3 ---
 1 file changed, 3 deletions(-)

--- a/mm/filemap.c
+++ b/mm/filemap.c
@@ -2977,9 +2977,6 @@ inline ssize_t generic_write_checks(stru
 	loff_t count;
 	int ret;
 
-	if (IS_SWAPFILE(inode))
-		return -ETXTBSY;
-
 	if (!iov_iter_count(from))
 		return 0;
 
