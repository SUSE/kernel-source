From: Petr Tesarik <ptesarik@suse.com>
Subject: Add product identifying information to VMCOREINFO
Patch-mainline: Never, SUSE-specific
References: bsc#1123015

Since SUSE kernels sometimes backport patches that change the structures
required to save a dump file using makedumpfile, it is necessary to recognize
such a patched kernel from a vanilla kernel in the kdump environment. The
VMCOREINFO note is perfect for this purpose.

Signed-off-by: Petr Tesarik <ptesarik@suse.com>
---
 kernel/vmcore_info.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/kernel/vmcore_info.c
+++ b/kernel/vmcore_info.c
@@ -20,6 +20,8 @@
 
 #include <crypto/sha1.h>
 
+#include <generated/uapi/linux/suse_version.h>
+
 #include "kallsyms_internal.h"
 #include "kexec_internal.h"
 
@@ -136,6 +138,7 @@ static int __init crash_save_vmcoreinfo_
 	}
 
 	VMCOREINFO_OSRELEASE(init_uts_ns.name.release);
+	VMCOREINFO_NUMBER(SUSE_PRODUCT_CODE);
 	VMCOREINFO_BUILD_ID();
 	VMCOREINFO_PAGESIZE(PAGE_SIZE);
 
