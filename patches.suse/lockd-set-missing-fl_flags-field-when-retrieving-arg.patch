From: Jeff Layton <jlayton@kernel.org>
Date: Fri, 11 Nov 2022 14:36:36 -0500
Subject: [PATCH] lockd: set missing fl_flags field when retrieving args
Git-commit: 75c7940d2a86d3f1b60a0a265478cb8fc887b970
Patch-mainline: v6.2
References: git-fixes

Signed-off-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Acked-by: NeilBrown <neilb@suse.com>

---
 fs/lockd/svc4proc.c |    1 +
 fs/lockd/svcproc.c  |    1 +
 2 files changed, 2 insertions(+)

--- a/fs/lockd/svc4proc.c
+++ b/fs/lockd/svc4proc.c
@@ -49,6 +49,7 @@ nlm4svc_retrieve_args(struct svc_rqst *r
 		*filp = file;
 
 		/* Set up the missing parts of the file_lock structure */
+		lock->fl.fl_flags = FL_POSIX;
 		lock->fl.fl_file  = file->f_file;
 		lock->fl.fl_pid = current->tgid;
 		lock->fl.fl_start = (loff_t)lock->lock_start;
--- a/fs/lockd/svcproc.c
+++ b/fs/lockd/svcproc.c
@@ -75,6 +75,7 @@ nlmsvc_retrieve_args(struct svc_rqst *rq
 		*filp = file;
 
 		/* Set up the missing parts of the file_lock structure */
+		lock->fl.fl_flags = FL_POSIX;
 		lock->fl.fl_file  = file->f_file;
 		lock->fl.fl_pid = current->tgid;
 		lock->fl.fl_lmops = &nlmsvc_lock_operations;
