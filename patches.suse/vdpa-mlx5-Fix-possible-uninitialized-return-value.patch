From: Eli Cohen <elic@nvidia.com>
Date: Thu, 11 Aug 2022 16:40:10 +0300
Subject: vdpa/mlx5: Fix possible uninitialized return value
Patch-mainline: v6.0-rc1
Git-commit: 93e530d2a1c4c0fcce45e01ae6c5c6287a08d3e3
References: jsc#PED-1549

Initialize err local variable to return -EAGAIN if the asid cannot be
found thus avoiding returning uninitialized value.

Fixes: 8fcd20c30704 ("vdpa/mlx5: Support different address spaces for control and data")
Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
Signed-off-by: Eli Cohen <elic@nvidia.com>
Message-Id: <20220811134010.952291-1-elic@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/vdpa/mlx5/net/mlx5_vnet.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/drivers/vdpa/mlx5/net/mlx5_vnet.c
+++ b/drivers/vdpa/mlx5/net/mlx5_vnet.c
@@ -2659,7 +2659,7 @@ static int mlx5_vdpa_set_map(struct vdpa
 {
 	struct mlx5_vdpa_dev *mvdev = to_mvdev(vdev);
 	struct mlx5_vdpa_net *ndev = to_mlx5_vdpa_ndev(mvdev);
-	int err;
+	int err = -EINVAL;
 
 	down_write(&ndev->reslock);
 	if (mvdev->group2asid[MLX5_VDPA_DATAVQ_GROUP] == asid) {
