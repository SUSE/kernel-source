From: Michal Koutný <mkoutny@suse.com>
Date: Tue, 26 Aug 2025 17:23:03 +0200
Subject: build_bug.h: Add KABI assert
Patch-mainline: Never, SUSE-specific
References: bsc#1249186

Add a semantic macro for build checks of constraints for KABI workarounds.

Suggested-by: Shung-Hsi Yu <shung-hsi.yu@suse.com>
Signed-off-by: Michal Koutný <mkoutny@suse.com>
---
 include/linux/build_bug.h |    5 +++++
 1 file changed, 5 insertions(+)

--- a/include/linux/build_bug.h
+++ b/include/linux/build_bug.h
@@ -77,4 +77,9 @@
 #define static_assert(expr, ...) __static_assert(expr, ##__VA_ARGS__, #expr)
 #define __static_assert(expr, msg, ...) _Static_assert(expr, msg)
 
+#ifdef CONFIG_SUSE_HAVE_STABLE_KABI
+#define suse_kabi_static_assert(...) static_assert(__VA_ARGS__)
+#else
+#define suse_kabi_static_assert(...) /* empty */
+#endif
 #endif	/* _LINUX_BUILD_BUG_H */
