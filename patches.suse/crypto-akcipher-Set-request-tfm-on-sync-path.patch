From: Herbert Xu <herbert@gondor.apana.org.au>
Date: Mon, 26 Jun 2023 18:20:25 +0800
Subject: crypto: akcipher - Set request tfm on sync path
Patch-mainline: v6.5-rc1
Git-commit: 767cfee8368f43c6d6c58cdf8c2d143a027fa55f
References: jsc#PED-5460

The request tfm needs to be set.

Fixes: addde1f2c966 ("crypto: akcipher - Add sync interface without SG lists")
Reported-by: kernel test robot <oliver.sang@intel.com>
Closes: https://lore.kernel.org/oe-lkp/202306261421.2ac744fa-oliver.sang@intel.com
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Acked-by: Lee, Chun-Yi <jlee@suse.com>
---
 crypto/akcipher.c |    1 +
 1 file changed, 1 insertion(+)

--- a/crypto/akcipher.c
+++ b/crypto/akcipher.c
@@ -207,6 +207,7 @@ int crypto_akcipher_sync_prep(struct cry
 		return -ENOMEM;
 
 	data->req = req;
+	akcipher_request_set_tfm(req, data->tfm);
 
 	buf = (u8 *)(req + 1) + reqsize;
 	data->buf = buf;
