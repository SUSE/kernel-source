From f26e648a978ae7958e0958095768363c851a736d Mon Sep 17 00:00:00 2001
From: Selvin Xavier <selvin.xavier@broadcom.com>
Date: Sat, 8 Feb 2025 05:48:26 -0800
Subject: [PATCH 1/1] RDMA/bnxt_re: Fix the condition check while programming
 congestion control
Git-commit: f26e648a978ae7958e0958095768363c851a736d
Patch-mainline: v6.15-rc1
References: jsc#PED-15349

Program the Congestion control values when the CC gen matches.
Fix the condition check for the same.

Fixes: 656dff55da19 ("RDMA/bnxt_re: Congestion control settings using debugfs hook")
Reported-by: Kalesh AP <kalesh-anakkur.purayil@broadcom.com>
Reported-by: Chengchang Tang <tangchengchang@huawei.com>
Signed-off-by: Selvin Xavier <selvin.xavier@broadcom.com>
Link: https://patch.msgid.link/1739022506-8937-1-git-send-email-selvin.xavier@broadcom.com
Signed-off-by: Leon Romanovsky <leon@kernel.org>
Acked-by: Nicolas Morey <nmorey@suse.com>
---
 drivers/infiniband/hw/bnxt_re/debugfs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/infiniband/hw/bnxt_re/debugfs.c b/drivers/infiniband/hw/bnxt_re/debugfs.c
index d7354e7753fe..af91d16c3c77 100644
--- a/drivers/infiniband/hw/bnxt_re/debugfs.c
+++ b/drivers/infiniband/hw/bnxt_re/debugfs.c
@@ -265,7 +265,7 @@ static int bnxt_re_configure_cc(struct bnxt_re_dev *rdev, u32 gen_ext, u32 offse
 	struct bnxt_qplib_cc_param ccparam = { };
 
 	/* Supporting only Gen 0 now */
-	if (gen_ext != CC_CONFIG_GEN0_EXT0)
+	if (gen_ext == CC_CONFIG_GEN0_EXT0)
 		bnxt_re_fill_gen0_ext0(&ccparam, offset, val);
 	else
 		return -EINVAL;
-- 
2.52.0

