From: Danielle Ratson <danieller@nvidia.com>
Date: Thu, 11 Jul 2024 11:09:34 +0300
Subject: net: ethtool: Monotonically increase the message sequence number
Patch-mainline: v6.11-rc1
Git-commit: 275a63c9fe10f39066782d2d775d7d3efb20b01f
References: bsc#1232798

Currently, during the module firmware flashing process, unicast
notifications are sent from the kernel using the same sequence number,
making it impossible for user space to track missed notifications.

Monotonically increase the message sequence number, so the order of
notifications could be tracked effectively.

Signed-off-by: Danielle Ratson <danieller@nvidia.com>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Reviewed-by: Jakub Kicinski <kuba@kernel.org>
Link: https://patch.msgid.link/20240711080934.2071869-1-danieller@nvidia.com
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 net/ethtool/module.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/net/ethtool/module.c
+++ b/net/ethtool/module.c
@@ -488,7 +488,7 @@ ethnl_module_fw_flash_ntf(struct net_dev
 	if (!skb)
 		return;
 
-	hdr = ethnl_unicast_put(skb, ntf_params->portid, ntf_params->seq,
+	hdr = ethnl_unicast_put(skb, ntf_params->portid, ++ntf_params->seq,
 				ETHTOOL_MSG_MODULE_FW_FLASH_NTF);
 	if (!hdr)
 		goto err_skb;
