From: Christoph Hellwig <hch@lst.de>
Date: Mon, 4 Nov 2024 08:39:31 +0100
Subject: [PATCH] block: remove the max_zone_append_sectors check in
 blk_revalidate_disk_zones
Git-commit: e494c3dce6981c0b19fee79928b293a1cf0af867
Patch-mainline: v6.13-rc1
References: jsc#PED-9651

With the lock layer zone append emulation, we are now always setting a
max_zone_append_sectors value for zoned devices and this check can't
ever trigger.

Signed-off-by: Christoph Hellwig <hch@lst.de>
Link: https://lore.kernel.org/r/20241104073955.112324-2-hch@lst.de
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Acked-by: Hannes Reinecke <hare@suse.com>
---
 block/blk-zoned.c | 6 ------
 1 file changed, 6 deletions(-)

diff --git a/block/blk-zoned.c b/block/blk-zoned.c
index af19296fa50d..a287577d1ad6 100644
--- a/block/blk-zoned.c
+++ b/block/blk-zoned.c
@@ -1774,12 +1774,6 @@ int blk_revalidate_disk_zones(struct gendisk *disk)
 		return -ENODEV;
 	}
 
-	if (!queue_max_zone_append_sectors(q)) {
-		pr_warn("%s: Invalid 0 maximum zone append limit\n",
-			disk->disk_name);
-		return -ENODEV;
-	}
-
 	/*
 	 * Ensure that all memory allocations in this context are done as if
 	 * GFP_NOIO was specified.
-- 
2.35.3

