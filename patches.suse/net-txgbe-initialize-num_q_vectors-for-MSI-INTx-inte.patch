From: Jiawen Wu <jiawenwu@trustnetic.com>
Date: Mon, 1 Jul 2024 15:14:13 +0800
Subject: net: txgbe: initialize num_q_vectors for MSI/INTx interrupts
Patch-mainline: v6.10-rc7
Git-commit: 7c36711a2cd8059c2d24f5e5c1d76e8ea2d5613c
References: CVE-2024-42113 bsc#1228568

When using MSI/INTx interrupts, wx->num_q_vectors is uninitialized.
Thus there will be kernel panic in wx_alloc_q_vectors() to allocate
queue vectors.

Fixes: 3f703186113f ("net: libwx: Add irq flow functions")
Signed-off-by: Jiawen Wu <jiawenwu@trustnetic.com>
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/ethernet/wangxun/libwx/wx_lib.c |    1 +
 1 file changed, 1 insertion(+)

--- a/drivers/net/ethernet/wangxun/libwx/wx_lib.c
+++ b/drivers/net/ethernet/wangxun/libwx/wx_lib.c
@@ -956,6 +956,7 @@ static int wx_set_interrupt_capability(s
 	}
 
 	pdev->irq = pci_irq_vector(pdev, 0);
+	wx->num_q_vectors = 1;
 
 	return 0;
 }
