From 603fbdc1122565dd5bb3fc0b3f574afe5ac49cd9 Mon Sep 17 00:00:00 2001
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date: Sat, 23 Sep 2023 22:49:06 +0300
Subject: [PATCH] media: rkisp1: resizer: Use v4l2_area instead of v4l2_rect to
 store size
Git-commit: 603fbdc1122565dd5bb3fc0b3f574afe5ac49cd9
References: jsc#PED-10837
Patch-mainline: v6.7-rc1

The rkisp1_rsz_config() and rkisp1_rsz_config_regs() functions use a
v4l2_rect to pass frame sizes, leaving the top and left members unused
and uninitialized. Use v4l2_area instead.

Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Reviewed-by: Sakari Ailus <sakari.ailus@linux.intel.com>
Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
Signed-off-by: Oliver Neukum <oneukum@suse.com>

---
 drivers/media/platform/rockchip/rkisp1/rkisp1-resizer.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/drivers/media/platform/rockchip/rkisp1/rkisp1-resizer.c b/drivers/media/platform/rockchip/rkisp1/rkisp1-resizer.c
index 26f9c16ccc3e..8700be7d19aa 100644
--- a/drivers/media/platform/rockchip/rkisp1/rkisp1-resizer.c
+++ b/drivers/media/platform/rockchip/rkisp1/rkisp1-resizer.c
@@ -208,8 +208,8 @@ static void rkisp1_rsz_disable(struct rkisp1_resizer *rsz,
 static void rkisp1_rsz_config_regs(struct rkisp1_resizer *rsz,
 				   const struct v4l2_rect *sink_y,
 				   const struct v4l2_rect *sink_c,
-				   const struct v4l2_rect *src_y,
-				   const struct v4l2_rect *src_c,
+				   const struct v4l2_area *src_y,
+				   const struct v4l2_area *src_c,
 				   enum rkisp1_shadow_regs_when when)
 {
 	u32 ratio, rsz_ctrl = 0;
@@ -272,7 +272,8 @@ static void rkisp1_rsz_config(struct rkisp1_resizer *rsz,
 	const struct rkisp1_rsz_yuv_mbus_info *sink_yuv_info, *src_yuv_info;
 	const struct v4l2_mbus_framefmt *src_fmt, *sink_fmt;
 	const struct v4l2_rect *sink_crop;
-	struct v4l2_rect sink_y, sink_c, src_y, src_c;
+	struct v4l2_rect sink_y, sink_c;
+	struct v4l2_area src_y, src_c;
 
 	sink_fmt = v4l2_subdev_get_pad_format(&rsz->sd, sd_state,
 					      RKISP1_RSZ_PAD_SINK);
-- 
2.47.0

