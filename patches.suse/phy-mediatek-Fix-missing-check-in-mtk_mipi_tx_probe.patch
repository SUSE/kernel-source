From 399c91c3f30531593e5ff6ca7b53f47092128669 Mon Sep 17 00:00:00 2001
From: Miaoqian Lin <linmq006@gmail.com>
Date: Fri, 24 Dec 2021 08:21:03 +0000
Subject: [PATCH] phy: mediatek: Fix missing check in mtk_mipi_tx_probe
Git-commit: 399c91c3f30531593e5ff6ca7b53f47092128669
Patch-mainline: v5.17-rc1
References: git-fixes

The of_device_get_match_data() function may return NULL.
Add check to prevent potential null dereference.

Signed-off-by: Miaoqian Lin <linmq006@gmail.com>
Reviewed-by: AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>
Link: https://lore.kernel.org/r/20211224082103.7658-1-linmq006@gmail.com
Signed-off-by: Vinod Koul <vkoul@kernel.org>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/phy/mediatek/phy-mtk-mipi-dsi.c |    2 ++
 1 file changed, 2 insertions(+)

--- a/drivers/phy/mediatek/phy-mtk-mipi-dsi.c
+++ b/drivers/phy/mediatek/phy-mtk-mipi-dsi.c
@@ -147,6 +147,8 @@ static int mtk_mipi_tx_probe(struct plat
 		return -ENOMEM;
 
 	mipi_tx->driver_data = of_device_get_match_data(dev);
+	if (!mipi_tx->driver_data)
+		return -ENODEV;
 
 	mem = platform_get_resource(pdev, IORESOURCE_MEM, 0);
 	mipi_tx->regs = devm_ioremap_resource(dev, mem);
