From: "Rafael J. Wysocki" <rafael.j.wysocki@intel.com>
Date: Wed, 13 Aug 2025 12:36:04 +0200
Subject: ACPI: processor: idle: Add module import namespace
Patch-mainline: v6.18-rc1
Git-commit: eb58738d1546bababc77392968ece9c595b4f737
References: jsc#PED-14260

Add a new module import namespace called ACPI_PROCESSOR_IDLE for
functions exported from the non-modular part of the ACPI processor
driver to the modular part of it.

Export acpi_processor_claim_cst_control() and acpi_processor_evaluate_cst()
in that namespace to hide them from unrelated modules.

They are also used by the intel_idle driver, but it is non-modular,
so it can call them regardless of the way the symbols are exported.

Joey Lee:
This patches be modified for not using string literal in symbol namespace
because we do not backport 'cdd30ebb1b9f module: Convert symbol namespace
to string literal'

Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Link: https://patch.msgid.link/3376499.aeNJFYEL58@rafael.j.wysocki
Acked-by: Chun-Yi Lee <jlee@suse.com>
---
 drivers/acpi/acpi_processor.c |    4 ++--
 drivers/acpi/processor_idle.c |    2 ++
 2 files changed, 4 insertions(+), 2 deletions(-)

--- a/drivers/acpi/acpi_processor.c
+++ b/drivers/acpi/acpi_processor.c
@@ -815,7 +815,7 @@ bool acpi_processor_claim_cst_control(vo
 	cst_control_claimed = true;
 	return true;
 }
-EXPORT_SYMBOL_GPL(acpi_processor_claim_cst_control);
+EXPORT_SYMBOL_NS_GPL(acpi_processor_claim_cst_control, ACPI_PROCESSOR_IDLE);
 
 /**
  * acpi_processor_evaluate_cst - Evaluate the processor _CST control method.
@@ -994,5 +994,5 @@ end:
 
 	return ret;
 }
-EXPORT_SYMBOL_GPL(acpi_processor_evaluate_cst);
+EXPORT_SYMBOL_NS_GPL(acpi_processor_evaluate_cst, ACPI_PROCESSOR_IDLE);
 #endif /* CONFIG_ACPI_PROCESSOR_CSTATE */
--- a/drivers/acpi/processor_idle.c
+++ b/drivers/acpi/processor_idle.c
@@ -1456,3 +1456,5 @@ int acpi_processor_power_exit(struct acp
 	pr->flags.power_setup_done = 0;
 	return 0;
 }
+
+MODULE_IMPORT_NS(ACPI_PROCESSOR_IDLE);
