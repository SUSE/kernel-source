From: Christoph Hellwig <hch@lst.de>
Date: Tue, 23 Nov 2021 19:53:08 +0100
Subject: [PATCH] block: don't include blk-mq-sched.h in blk.h
Git-commit: 2aa7745bf6db55b7800c4433e102b07c649fd001
Patch-mainline: v5.17-rc1
References: jsc#PED-1183

No needed, shift it into the source files that need it instead.

Signed-off-by: Christoph Hellwig <hch@lst.de>
Link: https://lore.kernel.org/r/20211123185312.1432157-5-hch@lst.de
Signed-off-by: Jens Axboe <axboe@kernel.dk>
Acked-by: Hannes Reinecke <hare@suse.com>
---
 block/blk-core.c       | 1 +
 block/blk-ioc.c        | 1 +
 block/blk-merge.c      | 1 +
 block/blk-mq-debugfs.c | 1 +
 block/blk-sysfs.c      | 1 +
 block/blk.h            | 1 -
 block/genhd.c          | 1 +
 7 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/block/blk-core.c b/block/blk-core.c
index 2053d1b0e90e..1acd94ba10c7 100644
--- a/block/blk-core.c
+++ b/block/blk-core.c
@@ -46,6 +46,7 @@
 #include <trace/events/block.h>
 
 #include "blk.h"
+#include "blk-mq-sched.h"
 #include "blk-pm.h"
 #include "blk-throttle.h"
 
diff --git a/block/blk-ioc.c b/block/blk-ioc.c
index 57299f860d41..70c99e85aee5 100644
--- a/block/blk-ioc.c
+++ b/block/blk-ioc.c
@@ -11,6 +11,7 @@
 #include <linux/sched/task.h>
 
 #include "blk.h"
+#include "blk-mq-sched.h"
 
 /*
  * For io context allocations
diff --git a/block/blk-merge.c b/block/blk-merge.c
index ba761c3f482b..456fb88c49b1 100644
--- a/block/blk-merge.c
+++ b/block/blk-merge.c
@@ -12,6 +12,7 @@
 #include <trace/events/block.h>
 
 #include "blk.h"
+#include "blk-mq-sched.h"
 #include "blk-rq-qos.h"
 #include "blk-throttle.h"
 
diff --git a/block/blk-mq-debugfs.c b/block/blk-mq-debugfs.c
index f4022b198580..7f27dca3a45e 100644
--- a/block/blk-mq-debugfs.c
+++ b/block/blk-mq-debugfs.c
@@ -11,6 +11,7 @@
 #include "blk.h"
 #include "blk-mq.h"
 #include "blk-mq-debugfs.h"
+#include "blk-mq-sched.h"
 #include "blk-mq-tag.h"
 #include "blk-rq-qos.h"
 
diff --git a/block/blk-sysfs.c b/block/blk-sysfs.c
index 772347adc56b..4622da4bb992 100644
--- a/block/blk-sysfs.c
+++ b/block/blk-sysfs.c
@@ -16,6 +16,7 @@
 #include "blk.h"
 #include "blk-mq.h"
 #include "blk-mq-debugfs.h"
+#include "blk-mq-sched.h"
 #include "blk-wbt.h"
 #include "blk-throttle.h"
 
diff --git a/block/blk.h b/block/blk.h
index 4df2ce8d4999..db6efa351d3e 100644
--- a/block/blk.h
+++ b/block/blk.h
@@ -10,7 +10,6 @@
 #include <xen/xen.h>
 #include "blk-crypto-internal.h"
 #include "blk-mq.h"
-#include "blk-mq-sched.h"
 
 struct elevator_type;
 
diff --git a/block/genhd.c b/block/genhd.c
index 8e9cbf23c510..01606db8c625 100644
--- a/block/genhd.c
+++ b/block/genhd.c
@@ -27,6 +27,7 @@
 #include <linux/badblocks.h>
 
 #include "blk.h"
+#include "blk-mq-sched.h"
 #include "blk-rq-qos.h"
 
 static struct kobject *block_depr;
-- 
2.35.3

