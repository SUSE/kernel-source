From 9f8539fe299c250af42325eccff66e8b8d1f15da Mon Sep 17 00:00:00 2001
From: Jens Axboe <axboe@kernel.dk>
Date: Wed, 20 Mar 2024 19:09:50 -0600
Subject: [PATCH] io_uring/net: remove (now) dead code in io_netmsg_recycle()
Git-commit: 9f8539fe299c250af42325eccff66e8b8d1f15da
Patch-mainline: v6.10-rc1
References: bsc#1230569 jsc#PED-11603

All net commands have async data at this point, there's no reason to
check if this is the case or not.

Signed-off-by: Jens Axboe <axboe@kernel.dk>
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
---
 io_uring/net.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/io_uring/net.c b/io_uring/net.c
index 77f2eb79e5e0..adc6d6e1cce6 100644
--- a/io_uring/net.c
+++ b/io_uring/net.c
@@ -119,7 +119,7 @@ static void io_netmsg_recycle(struct io_kiocb *req, unsigned int issue_flags)
 {
 	struct io_async_msghdr *hdr = req->async_data;
 
-	if (!req_has_async_data(req) || issue_flags & IO_URING_F_UNLOCKED)
+	if (unlikely(issue_flags & IO_URING_F_UNLOCKED))
 		return;
 
 	/* Let normal cleanup path reap it if we fail adding to the cache */
-- 
2.47.0

