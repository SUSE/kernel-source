From: "Rafael J. Wysocki" <rafael.j.wysocki@intel.com>
Date: Tue, 9 Jan 2024 17:42:48 +0100
Subject: thermal: helpers: Rearrange thermal_cdev_set_cur_state()
Patch-mainline: v6.8-rc1
Git-commit: fd881eac3af6c4e36b34ce92d69fb1d7e95f5920
References: jsc#PED-11164

Change the code layout in thermal_cdev_set_cur_state() so it returns
early on errors which is more consistent with what happens elsewhere.

No intentional functional impact.

Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Reviewed-by: Daniel Lezcano <daniel.lezcano@linaro.org>
Acked-by: Chun-Yi Lee <jlee@suse.com>
---
 drivers/thermal/thermal_helpers.c |   13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

--- a/drivers/thermal/thermal_helpers.c
+++ b/drivers/thermal/thermal_helpers.c
@@ -155,13 +155,14 @@ static int thermal_cdev_set_cur_state(st
 	 * registering function checked the ops are correctly set
 	 */
 	ret = cdev->ops->set_cur_state(cdev, state);
-	if (!ret) {
-		thermal_notify_cdev_state_update(cdev, state);
-		thermal_cooling_device_stats_update(cdev, state);
-		thermal_debug_cdev_state_update(cdev, state);
-	}
+	if (ret)
+		return ret;
 
-	return ret;
+	thermal_notify_cdev_state_update(cdev, state);
+	thermal_cooling_device_stats_update(cdev, state);
+	thermal_debug_cdev_state_update(cdev, state);
+
+	return 0;
 }
 
 void __thermal_cdev_update(struct thermal_cooling_device *cdev)
