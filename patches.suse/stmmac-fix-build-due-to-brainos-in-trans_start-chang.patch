From: Alexander Lobakin <alexandr.lobakin@intel.com>
Date: Wed, 17 Nov 2021 16:29:17 +0100
Subject: stmmac: fix build due to brainos in trans_start changes
Patch-mainline: v5.17-rc1
Git-commit: e92af33e472cf3aa25fd14ae7760c113f5ac8c48
References: jsc#PED-370

txq_trans_cond_update() takes netdev_tx_queue *nq,
not nq->trans_start.

Fixes: 5337824f4dc4 ("net: annotate accesses to queue->trans_start")
Signed-off-by: Alexander Lobakin <alexandr.lobakin@intel.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: https://lore.kernel.org/r/20211117152917.3739-1-alexandr.lobakin@intel.com
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Acked-by: Thomas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/ethernet/stmicro/stmmac/stmmac_main.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
+++ b/drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
@@ -2390,7 +2390,7 @@ static bool stmmac_xdp_xmit_zc(struct st
 	bool work_done = true;
 
 	/* Avoids TX time-out as we are sharing with slow path */
-	txq_trans_cond_update(nq->trans_start);
+	txq_trans_cond_update(nq);
 
 	budget = min(budget, stmmac_tx_avail(priv, queue));
 
@@ -4688,7 +4688,7 @@ static int stmmac_xdp_xmit_back(struct s
 
 	__netif_tx_lock(nq, cpu);
 	/* Avoids TX time-out as we are sharing with slow path */
-	txq_trans_cond_update(nq->trans_start);
+	txq_trans_cond_update(nq);
 
 	res = stmmac_xdp_xmit_xdpf(priv, queue, xdpf, false);
 	if (res == STMMAC_XDP_TX)
