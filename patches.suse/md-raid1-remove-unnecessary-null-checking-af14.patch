From af140f806ae2679f9dba48ea0f5811da83854eb6 Mon Sep 17 00:00:00 2001
From: Gou Hao <gouhao@uniontech.com>
Date: Thu, 14 Dec 2023 23:14:58 +0800
Subject: [PATCH] md/raid1: remove unnecessary null checking
Git-commit: af140f806ae2679f9dba48ea0f5811da83854eb6
Patch-mainline: v6.8-rc1
References: jsc#PED-7542

If %__GFP_DIRECT_RECLAIM is set then bio_alloc_bioset will always
be able to allocate a bio. See comment of bio_alloc_bioset.

Signed-off-by: Gou Hao <gouhao@uniontech.com>
Signed-off-by: Song Liu <song@kernel.org>
Link: https://lore.kernel.org/r/20231214151458.28970-1-gouhao@uniontech.com
Signed-off-by: Coly Li <colyli@suse.de>
---
 drivers/md/raid1.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/drivers/md/raid1.c b/drivers/md/raid1.c
index 9348f1709512..19c9bf0060ae 100644
--- a/drivers/md/raid1.c
+++ b/drivers/md/raid1.c
@@ -1124,8 +1124,6 @@ static void alloc_behind_master_bio(struct r1bio *r1_bio,
 
 	behind_bio = bio_alloc_bioset(NULL, vcnt, 0, GFP_NOIO,
 				      &r1_bio->mddev->bio_set);
-	if (!behind_bio)
-		return;
 
 	/* discard op, we don't support writezero/writesame yet */
 	if (!bio_has_data(bio)) {
-- 
2.35.3

