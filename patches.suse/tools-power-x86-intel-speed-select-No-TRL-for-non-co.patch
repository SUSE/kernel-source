From 2fe8d2d7911fb4e380c3dcb5655e1a62bb14f75e Mon Sep 17 00:00:00 2001
From: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
Date: Thu, 7 Sep 2023 17:12:55 -0700
Subject: [PATCH] tools/power/x86/intel-speed-select: No TRL for non compute domains
Git-commit: 2fe8d2d7911fb4e380c3dcb5655e1a62bb14f75e
Patch-mainline: v6.7-rc1
References: jsc#PED-4647 bsc#1218554

Don't call to set or get TRL for domains in which there are no CPUs.

Signed-off-by: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
Acked-by: Takashi Iwai <tiwai@suse.de>

---
 tools/power/x86/intel-speed-select/isst-config.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/tools/power/x86/intel-speed-select/isst-config.c b/tools/power/x86/intel-speed-select/isst-config.c
index 72be2d4db21c..1afaaa833a54 100644
--- a/tools/power/x86/intel-speed-select/isst-config.c
+++ b/tools/power/x86/intel-speed-select/isst-config.c
@@ -2574,6 +2574,9 @@ static void get_set_trl(struct isst_id *id, void *arg1, void *arg2, void *arg3,
 	int set = *(int *)arg4;
 	int ret;
 
+	if (id->cpu < 0)
+		return;
+
 	if (set && !fact_trl) {
 		isst_display_error_info_message(1, "Invalid TRL. Specify with [-t|--trl]", 0, 0);
 		exit(0);
-- 
2.35.3

