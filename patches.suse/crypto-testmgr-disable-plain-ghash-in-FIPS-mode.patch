From: Nicolai Stange <nstange@suse.de>
Date: Mon, 31 Jan 2022 16:26:41 +0100
Subject: [PATCH] crypto: testmgr - disallow plain ghash in FIPS mode
References: jsc#SLE-21132,bsc#1194777
Patch-mainline: Not yet, to be posted soon once prerequisites have landed

ghash may be used only as part of the gcm(aes) construction in FIPS
mode. Mark plain ghash as non-approved in testmgr.

Signed-off-by: Nicolai Stange <nstange@suse.de>
---
 crypto/testmgr.c |    1 -
 1 file changed, 1 deletion(-)

--- a/crypto/testmgr.c
+++ b/crypto/testmgr.c
@@ -4960,7 +4960,6 @@ static const struct alg_test_desc alg_te
 	}, {
 		.alg = "ghash",
 		.test = alg_test_hash,
-		.fips_allowed = 1,
 		.suite = {
 			.hash = __VECS(ghash_tv_template)
 		}
