From: Chuck Lever <chuck.lever@oracle.com>
Date: Sun, 3 Apr 2022 12:25:55 -0400
Subject: [PATCH] SUNRPC: Remove dead code in svc_tcp_release_rqst()
Git-commit: 4af8b42e5629b97bdde287d5d6c250535d324676
Patch-mainline: v5.19
References: git-fixes

Clean up: svc_tcp_sendto() always sets rq_xprt_ctxt to NULL.

Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Acked-by: NeilBrown <neilb@suse.com>

---
 net/sunrpc/svcsock.c |    9 ---------
 1 file changed, 9 deletions(-)

--- a/net/sunrpc/svcsock.c
+++ b/net/sunrpc/svcsock.c
@@ -117,15 +117,6 @@ static void svc_reclassify_socket(struct
  */
 static void svc_tcp_release_rqst(struct svc_rqst *rqstp)
 {
-	struct sk_buff *skb = rqstp->rq_xprt_ctxt;
-
-	if (skb) {
-		struct svc_sock *svsk =
-			container_of(rqstp->rq_xprt, struct svc_sock, sk_xprt);
-
-		rqstp->rq_xprt_ctxt = NULL;
-		skb_free_datagram_locked(svsk->sk_sk, skb);
-	}
 }
 
 /**
