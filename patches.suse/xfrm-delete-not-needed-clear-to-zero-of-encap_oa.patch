From a94fd40a18ae76ba76dbaa8eca0e3c46aa1142c1 Mon Sep 17 00:00:00 2001
From: Leon Romanovsky <leonro@nvidia.com>
Date: Tue, 6 Jun 2023 13:23:06 +0300
Subject: [PATCH] xfrm: delete not-needed clear to zero of encap_oa
Git-commit: a94fd40a18ae76ba76dbaa8eca0e3c46aa1142c1
Patch-mainline: v6.6-rc1
References: bsc#1220419

After commit 2f4796518315 ("af_key: Fix heap information leak"), there is
no need to clear encap_oa again as it is already initialized to zero.

Signed-off-by: Leon Romanovsky <leonro@nvidia.com>
Reviewed-by: Simon Horman <simon.horman@corigine.com>
Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>
Signed-off-by: Jiri Wiesner <jwiesner@suse.de>
---
 net/key/af_key.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/net/key/af_key.c b/net/key/af_key.c
index a815f5ab4c49..1cb4560afd44 100644
--- a/net/key/af_key.c
+++ b/net/key/af_key.c
@@ -1281,7 +1281,6 @@ static struct xfrm_state * pfkey_msg2xfrm_state(struct net *net,
 				ext_hdrs[SADB_X_EXT_NAT_T_DPORT-1];
 			natt->encap_dport = n_port->sadb_x_nat_t_port_port;
 		}
-		memset(&natt->encap_oa, 0, sizeof(natt->encap_oa));
 	}
 
 	err = xfrm_init_state(x);
-- 
2.35.3

