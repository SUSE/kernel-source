From: Christian Brauner <brauner@kernel.org>
Date: Mon, 31 Mar 2025 14:42:11 +0200
Subject: libfs: export find_next_child()
Patch-mainline: v6.16-rc1
Git-commit: 33445d6fc5206ef7fad185704bf241a9e9c3b2b9
References: jsc#PED-14259

Export find_next_child() so it can be used by efivarfs.
Keep it internal for now. There's no reason to advertise this
kernel-wide.

Link: https://lore.kernel.org/r/20250331-work-freeze-v1-1-6dfbe8253b9f@kernel.org
Signed-off-by: Christian Brauner <brauner@kernel.org>
Acked-by: Chun-Yi Lee <jlee@suse.com>
---
 fs/internal.h |    1 +
 fs/libfs.c    |    3 ++-
 2 files changed, 3 insertions(+), 1 deletion(-)

--- a/fs/internal.h
+++ b/fs/internal.h
@@ -339,3 +339,4 @@ static inline bool path_mounted(const st
 	return path->mnt->mnt_root == path->dentry;
 }
 void file_f_owner_release(struct file *file);
+struct dentry *find_next_child(struct dentry *parent, struct dentry *prev);
--- a/fs/libfs.c
+++ b/fs/libfs.c
@@ -574,7 +574,7 @@ const struct file_operations simple_offs
 	.fsync		= noop_fsync,
 };
 
-static struct dentry *find_next_child(struct dentry *parent, struct dentry *prev)
+struct dentry *find_next_child(struct dentry *parent, struct dentry *prev)
 {
 	struct dentry *child = NULL, *d;
 
@@ -594,6 +594,7 @@ static struct dentry *find_next_child(st
 	dput(prev);
 	return child;
 }
+EXPORT_SYMBOL(find_next_child);
 
 void simple_recursive_removal(struct dentry *dentry,
                               void (*callback)(struct dentry *))
