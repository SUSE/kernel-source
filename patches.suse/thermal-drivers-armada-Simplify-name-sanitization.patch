From: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Date: Wed, 20 Mar 2024 11:49:39 +0100
Subject: thermal/drivers/armada: Simplify name sanitization
Patch-mainline: v6.10-rc1
Git-commit: 58b1569244fea51cbf675774fad9423359d76c57
References: jsc#PED-11164

Simplify the code by using the helper we have for doing exactly this.

Signed-off-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Reviewed-by: Miquel Raynal <miquel.raynal@bootlin.com>
Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
Link: https://lore.kernel.org/r/20240320104940.65031-1-linux@rasmusvillemoes.dk
Acked-by: Chun-Yi Lee <jlee@suse.com>
---
 drivers/thermal/armada_thermal.c |    9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

--- a/drivers/thermal/armada_thermal.c
+++ b/drivers/thermal/armada_thermal.c
@@ -735,7 +735,6 @@ static void armada_set_sane_name(struct
 				 struct armada_thermal_priv *priv)
 {
 	const char *name = dev_name(&pdev->dev);
-	char *insane_char;
 
 	if (strlen(name) > THERMAL_NAME_LENGTH) {
 		/*
@@ -753,12 +752,8 @@ static void armada_set_sane_name(struct
 	/* Save the name locally */
 	strscpy(priv->zone_name, name, THERMAL_NAME_LENGTH);
 
-	/* Then check there are no '-' or hwmon core will complain */
-	do {
-		insane_char = strpbrk(priv->zone_name, "-");
-		if (insane_char)
-			*insane_char = '_';
-	} while (insane_char);
+	/* Then ensure there are no '-' or hwmon core will complain */
+	strreplace(priv->zone_name, '-', '_');
 }
 
 /*
