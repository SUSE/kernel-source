From 95d1fef53782eb409d4578ce6101d2a7b055351c Mon Sep 17 00:00:00 2001
From: Eric DeVolder <eric.devolder@oracle.com>
Date: Wed, 2 Aug 2023 12:17:50 -0400
Subject: [PATCH 15/15] remove ARCH_DEFAULT_KEXEC from Kconfig.kexec
Patch-mainline: v6.6-rc1
Git-commit: 95d1fef53782eb409d4578ce6101d2a7b055351c
References: jsc#PED-5077

This patch is a minor cleanup to the series "refactor Kconfig to
consolidate KEXEC and CRASH options".

In that series, a new option ARCH_DEFAULT_KEXEC was introduced in order to
obtain the equivalent behavior of s390 original Kconfig settings for
KEXEC.  As it turns out, this new option did not fully provide the
equivalent behavior, rather a "select KEXEC" did.

As such, the ARCH_DEFAULT_KEXEC is not needed anymore, so remove it.

Link: https://lkml.kernel.org/r/20230802161750.2215-1-eric.devolder@oracle.com
Signed-off-by: Eric DeVolder <eric.devolder@oracle.com>
Acked-by: Alexander Gordeev <agordeev@linux.ibm.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Oscar Salvador <osalvador@suse.de>
---
 arch/s390/Kconfig    | 3 ---
 kernel/Kconfig.kexec | 1 -
 2 files changed, 4 deletions(-)

diff --git a/arch/s390/Kconfig b/arch/s390/Kconfig
index ab723218c0fb..4d011f7c26e5 100644
--- a/arch/s390/Kconfig
+++ b/arch/s390/Kconfig
@@ -245,9 +245,6 @@ config PGTABLE_LEVELS
 
 source "kernel/livepatch/Kconfig"
 
-config ARCH_DEFAULT_KEXEC
-	def_bool y
-
 config ARCH_SUPPORTS_KEXEC
 	def_bool y
 
diff --git a/kernel/Kconfig.kexec b/kernel/Kconfig.kexec
index ff72e45cfaef..701cd5336f4f 100644
--- a/kernel/Kconfig.kexec
+++ b/kernel/Kconfig.kexec
@@ -17,7 +17,6 @@ config HAVE_IMA_KEXEC
 
 config KEXEC
 	bool "Enable kexec system call"
-	default ARCH_DEFAULT_KEXEC
 	depends on ARCH_SUPPORTS_KEXEC
 	select KEXEC_CORE
 	help
-- 
2.42.0

