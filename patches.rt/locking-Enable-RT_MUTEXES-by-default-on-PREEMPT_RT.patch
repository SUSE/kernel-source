From 5ce9e0e820549b1786bcbbc979a9295a8e7fe87e Mon Sep 17 00:00:00 2001
From: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
Date: Wed, 26 Jan 2022 15:31:20 +0100
Subject: [PATCH] locking: Enable RT_MUTEXES by default on PREEMPT_RT.

References: SLE Realtime Extension
Patch-mainline: Queued in subsystem maintainer repository
Git-commit: cfdf822d3fd1407cd1eb0b77f080bbf566dd59e2
Git-repo: git://git.kernel.org/pub/scm/linux/kernel/git/rt/linux-rt-devel.git

The CONFIG_RT_MUTEXES option is enabled by CONFIG_FUTEX and CONFIG_I2C.
If both are disabled then CONFIG_PREEMPT_RT builds fail to compile.
It is not possible to have a PREEMPT_RT kernel without RT_MUTEX support
because RT_MUTEX based locking is always used.

Enable CONFIG_RT_MUTEXES by default on PREEMPT_RT builds.

Signed-off-by: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
Link: https://lkml.kernel.org/r/YgKmhjkcuqWXdUjQ@linutronix.de
Signed-off-by: Mel Gorman <mgorman@suse.de>
---
 init/Kconfig | 1 +
 1 file changed, 1 insertion(+)

diff --git a/init/Kconfig b/init/Kconfig
index aaeb8ee212a5..730715bf3d56 100644
--- a/init/Kconfig
+++ b/init/Kconfig
@@ -2040,6 +2040,7 @@ source "arch/Kconfig"
 
 config RT_MUTEXES
 	bool
+	default y if PREEMPT_RT
 
 config BASE_SMALL
 	int
