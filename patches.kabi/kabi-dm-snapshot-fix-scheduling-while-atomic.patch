From: Martin Wilck <mwilck@suse.com>
Subject: KABi: fix "dm-snapshot: fix 'scheduling while atomic' on real-time kernels"
Patch-mainline: Never, KABI
References: git-fixes

This commit changes an element of struct dm_exception from
"struct hlist_bl_node" to "struct hlist_node".

dm_exception is an internal data structure that is allocated by by the
dm snapshot code. So any 3rd party modules using it will most probably
not look into the internals of the structure. Also, the size of
the structure remains unchanged, as struct hlist_bl_node and struct
hlist_node have the same layout and size.

Just hide the change with __GENKSYMS__.

Signed-off-by: Martin Wilck <mwilck@suse.com>
Reviewed-by: Takashi Iwai <tiwai@suse.de>

---
 drivers/md/dm-exception-store.h |    4 ++++
 1 file changed, 4 insertions(+)

--- a/drivers/md/dm-exception-store.h
+++ b/drivers/md/dm-exception-store.h
@@ -29,7 +29,11 @@ typedef sector_t chunk_t;
  * chunk within the device.
  */
 struct dm_exception {
+#ifndef __GENKSYMS__	
 	struct hlist_node hash_list;
+#else
+	struct hlist_bl_node hash_list;
+#endif
 
 	chunk_t old_chunk;
 	chunk_t new_chunk;
