From: Michal Kubecek <mkubecek@suse.cz>
Date: Thu, 22 Aug 2024 14:04:54 +0200
Subject: kabi: hide include of ppp files from genksyms
Patch-mainline: Never, kabi workaround
References: CVE-2024-27016 bsc#1223807

The backport of mainline commit 0492d857636e ("netfilter: flowtable: Fix
QinQ and pppoe support for inet table") adds two include directives to
include/net/netfilter/nf_flow_table.h, resulting in many spurious
"became defined" errors in kabi check.

As usual, hide the include directives from genksyms.

Signed-off-by: Michal Kubecek <mkubecek@suse.cz>
---
 include/net/netfilter/nf_flow_table.h | 2 ++
 1 file changed, 2 insertions(+)

--- a/include/net/netfilter/nf_flow_table.h
+++ b/include/net/netfilter/nf_flow_table.h
@@ -10,8 +10,10 @@
 #include <linux/netfilter/nf_conntrack_tuple_common.h>
 #include <net/flow_offload.h>
 #include <net/dst.h>
+#ifndef __GENKSYMS__
 #include <linux/if_pppox.h>
 #include <linux/ppp_defs.h>
+#endif /* __GENKSYMS__ */
 
 struct nf_flowtable;
 struct nf_flow_rule;
