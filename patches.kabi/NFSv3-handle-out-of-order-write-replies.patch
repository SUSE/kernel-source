From: NeilBrown <neilb@suse.de>
Date: Tue, 13 Dec 2022 15:13:35 +1100
Subject: KABI fix for:  NFSv3: handle out-of-order write replies.
Patch-mainline: Never, kabi
References: bsc#1205544

Move new additioned to nfs_inode to the end, and hide from the kabi.

Signed-off-by: NeilBrown <neilb@suse.com>
---
 include/linux/nfs_fs.h |   44 +++++++++++++++++++++++---------------------
 1 file changed, 23 insertions(+), 21 deletions(-)

--- a/include/linux/nfs_fs.h
+++ b/include/linux/nfs_fs.h
@@ -182,6 +182,29 @@ struct nfs_inode {
 	struct rw_semaphore	rmdir_sem;
 	struct mutex		commit_mutex;
 
+#if IS_ENABLED(CONFIG_NFS_V4)
+	struct nfs4_cached_acl	*nfs4_acl;
+        /* NFSv4 state */
+	struct list_head	open_states;
+	struct nfs_delegation __rcu *delegation;
+	struct rw_semaphore	rwsem;
+
+	/* pNFS layout information */
+	struct pnfs_layout_hdr *layout;
+#endif /* CONFIG_NFS_V4*/
+	/* how many bytes have been written/read and how many bytes queued up */
+	__u64 write_io;
+	__u64 read_io;
+#ifdef CONFIG_NFS_FSCACHE
+	struct fscache_cookie	*fscache;
+#endif
+	struct inode		vfs_inode;
+
+#ifdef CONFIG_NFS_V4_2
+	struct nfs4_xattr_cache *xattr_cache;
+#endif
+
+#ifndef __GENKSYMS__
 	/* Keep track of out-of-order replies.
 	 * The ooo array contains start/end pairs of
 	 * numbers from the changeid sequence when
@@ -214,27 +237,6 @@ struct nfs_inode {
 			u64 start, end;
 		} gap[16];
 	} *ooo;
-
-#if IS_ENABLED(CONFIG_NFS_V4)
-	struct nfs4_cached_acl	*nfs4_acl;
-        /* NFSv4 state */
-	struct list_head	open_states;
-	struct nfs_delegation __rcu *delegation;
-	struct rw_semaphore	rwsem;
-
-	/* pNFS layout information */
-	struct pnfs_layout_hdr *layout;
-#endif /* CONFIG_NFS_V4*/
-	/* how many bytes have been written/read and how many bytes queued up */
-	__u64 write_io;
-	__u64 read_io;
-#ifdef CONFIG_NFS_FSCACHE
-	struct fscache_cookie	*fscache;
-#endif
-	struct inode		vfs_inode;
-
-#ifdef CONFIG_NFS_V4_2
-	struct nfs4_xattr_cache *xattr_cache;
 #endif
 };
 
