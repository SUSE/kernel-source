From 6c98800215f606d5dca2ec841d254ed4483a316c Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.com>
Date: Thu, 28 Aug 2025 11:16:49 +0200
Subject: [PATCH] hid: hide cleanup of hid_descriptor
Patch-mainline: Never (kABI fixup)
References: CVE-2025-38103 bsc#1245663

Binarily speaking an array of one element is equivalent
to a variable plus a zero length array. Just hide the
change,

Signed-off-by: Oliver Neukum <oneukum@suse.com>
---
 include/linux/hid.h | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/include/linux/hid.h b/include/linux/hid.h
index 017d31f1d..8ec545ba3 100644
--- a/include/linux/hid.h
+++ b/include/linux/hid.h
@@ -736,9 +736,13 @@ struct hid_descriptor {
 	__le16 bcdHID;
 	__u8  bCountryCode;
 	__u8  bNumDescriptors;
+#ifndef __GENKSYMS__
 	struct hid_class_descriptor rpt_desc;
 
 	struct hid_class_descriptor opt_descs[];
+#else
+	struct hid_class_descriptor desc[1];
+#endif
 } __attribute__ ((packed));
 
 #define HID_DEVICE(b, g, ven, prod)					\
-- 
2.51.0

