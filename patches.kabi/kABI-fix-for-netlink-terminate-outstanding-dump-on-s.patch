From: Steffen Jaeckel <sjaeckel@suse.de>
Subject: kABI fix for netlink: terminate outstanding dump on socket close
Patch-mainline: Never, kABI workaround
References: git-fixes

Upstream commit 1904fb9ebf91 ("netlink: terminate outstanding
dump on socket close") removed those lines which would break kABI.
Revert this removal.

Signed-off-by: Steffen Jaeckel <sjaeckel@suse.de>

---
 net/netlink/af_netlink.h | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/net/netlink/af_netlink.h b/net/netlink/af_netlink.h
index 9252ad6694a06..2145979b9986a 100644
--- a/net/netlink/af_netlink.h
+++ b/net/netlink/af_netlink.h
@@ -4,6 +4,7 @@
 
 #include <linux/rhashtable.h>
 #include <linux/atomic.h>
+#include <linux/workqueue.h>
 #include <net/sock.h>
 
 /* flags */
@@ -49,6 +50,7 @@ struct netlink_sock {
 
 	struct rhash_head	node;
 	struct rcu_head		rcu;
+	struct work_struct	work;
 };
 
 static inline struct netlink_sock *nlk_sk(struct sock *sk)
-- 
2.47.1

