From: Thomas Bogendoerfer <tbogendoerfer@suse.de>
Subject: ice: kabi protect ice_pf
Patch-mainline: Never, kABI workaround
References: bsc#1200502

Commit e523af4ee560 ("net/ice: Add support for enable_iwarp and enable_roce
 devlink param") add a new field rdma_mode, which breaks KABI. struct ice_pf
is allocated by the ice driver itself, so simply adding rdma_mode at
the end of struct ice_pf hidden for kabi checker is enough.

Signed-off-by: homas Bogendoerfer <tbogendoerfer@suse.de>
---
 drivers/net/ethernet/intel/ice/ice.h |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/drivers/net/ethernet/intel/ice/ice.h
+++ b/drivers/net/ethernet/intel/ice/ice.h
@@ -576,7 +576,6 @@ struct ice_pf {
 	struct ice_hw_port_stats stats_prev;
 	struct ice_hw hw;
 	u8 stat_prev_loaded:1; /* has previous stats been loaded */
-	u8 rdma_mode;
 	u16 dcbx_cap;
 	u32 tx_timeout_count;
 	unsigned long tx_timeout_last_recovery;
@@ -605,6 +604,9 @@ struct ice_pf {
 #define ICE_VF_AGG_NODE_ID_START	65
 #define ICE_MAX_VF_AGG_NODES		32
 	struct ice_agg_node vf_agg_node[ICE_MAX_VF_AGG_NODES];
+#ifndef __GENKSYMS__
+	u8 rdma_mode;
+#endif
 };
 
 struct ice_netdev_priv {
