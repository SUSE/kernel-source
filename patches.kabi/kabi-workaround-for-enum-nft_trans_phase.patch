From 591dbaae61738dd5901bcac1c67f2b1a9d74acd2 Mon Sep 17 00:00:00 2001
From: Denis Kirjanov <denis.kirjanov@suse.com>
Date: Tue, 17 Oct 2023 14:26:46 +0300
Subject: [PATCH 2/3] kabi: workaround for enum nft_trans_phase
Patch-mainline: Never (kABI fixup)
References: bsc#1215104

Hiding the new member from the KABI checker doesn't work
since altering the comma at the end of the enum produces the KABI
breakage. Lets add a new member using the macro

Signed-off-by: Denis Kirjanov <denis.kirjanov@suse.com>
---
 include/net/netfilter/nf_tables.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/include/net/netfilter/nf_tables.h b/include/net/netfilter/nf_tables.h
index 88b30b1c6d72..3bcb749a0e3a 100644
--- a/include/net/netfilter/nf_tables.h
+++ b/include/net/netfilter/nf_tables.h
@@ -881,12 +881,13 @@ struct nft_expr_type {
 
 enum nft_trans_phase {
 	NFT_TRANS_PREPARE,
-	NFT_TRANS_PREPARE_ERROR,
 	NFT_TRANS_ABORT,
 	NFT_TRANS_COMMIT,
 	NFT_TRANS_RELEASE
 };
 
+#define NFT_TRANS_PREPARE_ERROR	4
+
 struct nft_flow_rule;
 struct nft_offload_ctx;
 
-- 
2.16.4

