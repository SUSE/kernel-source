From: David Disseldorp <ddiss@suse.de>
Subject: [PATCH] kabi: sk_buff.scm_io_uring
Patch-mainline: Never, kABI fix
References: bsc#1204228 CVE-2022-2602

Commit 0091bfc81741 ("io_uring/af_unix: defer registered files gc to
io_uring") requires this kABI fix. pahole shows a gap here:
$ pahole -C sk_buff vmlinux
struct sk_buff {
  ...
  __u8                       tc_from_ingress:1;    /*   132: 0  1 */
  __u8                       decrypted:1;          /*   132: 1  1 */
  __u8                       scm_io_uring:1;       /*   132: 2  1 */

  /* XXX 5 bits hole, try to pack */
  /* XXX 1 byte hole, try to pack */

Signed-off-by: David Disseldorp <ddiss@suse.de>
---
 include/linux/skbuff.h | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/include/linux/skbuff.h b/include/linux/skbuff.h
index f86bbfcfa22ad..d305bf5ad125b 100644
--- a/include/linux/skbuff.h
+++ b/include/linux/skbuff.h
@@ -816,7 +816,9 @@ struct sk_buff {
 #ifdef CONFIG_TLS_DEVICE
 	__u8			decrypted:1;
 #endif
+#ifndef __GENKSYMS__
 	__u8                    scm_io_uring:1;
+#endif
 
 #ifdef CONFIG_NET_SCHED
 	__u16			tc_index;	/* traffic control index */
-- 
2.35.3

