From: Hannes Reinecke <hare@suse.de>
Date: Mon, 7 Feb 2022 08:41:37 +0100
Subject: [PATCH] scsi: kABI fix for 'eh_should_retry_cmd'
Patch-mainline: Never, kABI fix only
References: bsc#1195506

Patch 'scsi: core: No retries on abort success' introduced a new scsi host template
callback 'eh_should_retry_cmd', which of course breaks the kABI.
So add a kABI padding here.

Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 include/scsi/scsi_host.h | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/include/scsi/scsi_host.h b/include/scsi/scsi_host.h
index 531b30649ef0..e979b6bd0354 100644
--- a/include/scsi/scsi_host.h
+++ b/include/scsi/scsi_host.h
@@ -324,12 +324,6 @@ struct scsi_host_template {
 	 * Status: OPTIONAL
 	 */
 	enum blk_eh_timer_return (*eh_timed_out)(struct scsi_cmnd *);
-	/*
-	 * Optional routine that allows the transport to decide if a cmd
-	 * is retryable. Return true if the transport is in a state the
-	 * cmd should be retried on.
-	 */
-	bool (*eh_should_retry_cmd)(struct scsi_cmnd *scmd);
 
 	/* This is an optional routine that allows transport to initiate
 	 * LLD adapter or firmware reset using sysfs attribute.
@@ -502,6 +496,14 @@ struct scsi_host_template {
 	 */
 	unsigned int cmd_size;
 	struct scsi_host_cmd_pool *cmd_pool;
+#ifndef __GENKSYMS__
+	/*
+	 * Optional routine that allows the transport to decide if a cmd
+	 * is retryable. Return true if the transport is in a state the
+	 * cmd should be retried on.
+	 */
+	bool (*eh_should_retry_cmd)(struct scsi_cmnd *scmd);
+#endif
 };
 
 /*
-- 
2.29.2

