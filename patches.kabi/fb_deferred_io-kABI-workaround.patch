From: Takashi Iwai <tiwai@suse.de>
Subject: kABI workaround for struct fb_deferred_io changes
Patch-mainline: Never, kABI workaround
References: bsc#1208266

A new field was added to struct fb_deferred_io that broke kABI.
For keeping kABI compatibility, change it for short to fit into the
existing hole (3 bytes for armv7hl), and wrap with __GENKSYMS__.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/linux/fb.h |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/include/linux/fb.h
+++ b/include/linux/fb.h
@@ -212,7 +212,9 @@ struct fb_deferred_io {
 	/* delay between mkwrite and deferred handler */
 	unsigned long delay;
 	bool sort_pagereflist; /* sort pagelist by offset */
-	int open_count; /* number of opened files; protected by fb_info lock */
+#ifndef __GENKSYMS__
+	short open_count; /* number of opened files; protected by fb_info lock */
+#endif
 	struct mutex lock; /* mutex that protects the pageref list */
 	struct list_head pagereflist; /* list of pagerefs for touched pages */
 	/* callback */
