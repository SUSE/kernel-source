From fd1aa9692a7284ee3b0e9f1f5087228ecb027c3c Mon Sep 17 00:00:00 2001
From: Oliver Neukum <oneukum@suse.com>
Date: Tue, 19 Dec 2023 10:58:51 +0100
Subject: [PATCH] kABI: restore void return to typec_altmode_attention
Patch-mainline: Never (kABI fixup)
References: git-fixes

The error return is used only for logging

Signed-off-by: Oliver Neukum <oneukum@suse.com>
---
 drivers/usb/typec/bus.c           | 6 +++---
 drivers/usb/typec/tcpm/tcpm.c     | 3 +--
 include/linux/usb/typec_altmode.h | 2 +-
 3 files changed, 5 insertions(+), 6 deletions(-)

diff --git a/drivers/usb/typec/bus.c b/drivers/usb/typec/bus.c
index 407d2a846..4b729b700 100644
--- a/drivers/usb/typec/bus.c
+++ b/drivers/usb/typec/bus.c
@@ -154,20 +154,20 @@ EXPORT_SYMBOL_GPL(typec_altmode_exit);
  *
  * Notifies the partner of @adev about Attention command.
  */
-int typec_altmode_attention(struct typec_altmode *adev, u32 vdo)
+void typec_altmode_attention(struct typec_altmode *adev, u32 vdo)
 {
 	struct altmode *partner = to_altmode(adev)->partner;
 	struct typec_altmode *pdev;
 
 	if (!partner)
-		return -ENODEV;
+		return;
 
 	pdev = &partner->adev;
 
 	if (pdev->ops && pdev->ops->attention)
 		pdev->ops->attention(pdev, vdo);
 
-	return 0;
+	return;
 }
 EXPORT_SYMBOL_GPL(typec_altmode_attention);
 
diff --git a/drivers/usb/typec/tcpm/tcpm.c b/drivers/usb/typec/tcpm/tcpm.c
index fd2f7d83f..e684a8d07 100644
--- a/drivers/usb/typec/tcpm/tcpm.c
+++ b/drivers/usb/typec/tcpm/tcpm.c
@@ -1866,8 +1866,7 @@ static void tcpm_handle_vdm_request(struct tcpm_port *port,
 			}
 			break;
 		case ADEV_ATTENTION:
-			if (typec_altmode_attention(adev, p[1]))
-				tcpm_log(port, "typec_altmode_attention no port partner altmode");
+			typec_altmode_attention(adev, p[1]);
 			break;
 		}
 	}
diff --git a/include/linux/usb/typec_altmode.h b/include/linux/usb/typec_altmode.h
index 779479317..7c23a06e5 100644
--- a/include/linux/usb/typec_altmode.h
+++ b/include/linux/usb/typec_altmode.h
@@ -71,7 +71,7 @@ struct typec_altmode_ops {
 
 int typec_altmode_enter(struct typec_altmode *altmode, u32 *vdo);
 int typec_altmode_exit(struct typec_altmode *altmode);
-int typec_altmode_attention(struct typec_altmode *altmode, u32 vdo);
+void typec_altmode_attention(struct typec_altmode *altmode, u32 vdo);
 int typec_altmode_vdm(struct typec_altmode *altmode,
 		      const u32 header, const u32 *vdo, int count);
 int typec_altmode_notify(struct typec_altmode *altmode, unsigned long conf,
-- 
2.43.0

