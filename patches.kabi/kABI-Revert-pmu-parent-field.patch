From: Hannes Reinecke <hare@suse.de>
Subject: kABI: Revert pmu parent field
References: jsc#PED-10836
Patch-Mainline: never, kabi fixup

Drop the 'parent' field for the PMU device as it's only
adding a more detailed topology, but doesn't change the
functionality.

Signed-off-by: Hannes Reinecke <hare@suse.de>
---
 drivers/perf/cxl_pmu.c     |    1 -
 include/linux/perf_event.h |    1 -
 kernel/events/core.c       |    1 -
 3 files changed, 3 deletions(-)

--- a/drivers/perf/cxl_pmu.c
+++ b/drivers/perf/cxl_pmu.c
@@ -858,7 +858,6 @@ static int cxl_pmu_probe(struct device *
 
 	info->pmu = (struct pmu) {
 		.name = dev_name,
-		.parent = dev,
 		.module = THIS_MODULE,
 		.event_init = cxl_pmu_event_init,
 		.pmu_enable = cxl_pmu_enable,
--- a/include/linux/perf_event.h
+++ b/include/linux/perf_event.h
@@ -303,7 +303,6 @@ struct pmu {
 
 	struct module			*module;
 	struct device			*dev;
-	struct device			*parent;
 	const struct attribute_group	**attr_groups;
 	const struct attribute_group	**attr_update;
 	const char			*name;
--- a/kernel/events/core.c
+++ b/kernel/events/core.c
@@ -11502,7 +11502,6 @@ static int pmu_dev_alloc(struct pmu *pmu
 
 	dev_set_drvdata(pmu->dev, pmu);
 	pmu->dev->bus = &pmu_bus;
-	pmu->dev->parent = pmu->parent;
 	pmu->dev->release = pmu_dev_release;
 
 	ret = dev_set_name(pmu->dev, "%s", pmu->name);
