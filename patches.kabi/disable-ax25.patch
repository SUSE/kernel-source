From: Michal Hocko <mhocko@suse.com>
Subject: drop ax25 drivers
Patch-mainline: never, kabi fixup
References: bsc#1238471

While dealing with a CVSS 7+ CVE Marcus has noticed that
origin/SLE15-SP3-LTSS:config/arm64/default:CONFIG_AX25=m
origin/SLE15-SP3-LTSS:config/x86_64/default:CONFIG_AX25=m

while cve/linux-5.3-LTSS doesn't have it enabled (mostly because
15-SP2-LTSS didn't have it enabled too).

At the same time we have
origin/SLE15-SP3-LTSS:supported.conf:-!optional net/ax25/ax25

so the driver is not distributed anywhere at this stage.

Disabling CONFIG_AX25 would break kABI because of net_device::ax25_ptr.
Work this around by simply never compiling the driver (put it behind
non-existent CONFIG_AX25_REMOVED and leave CONFIG_AX25 in it existing
state).

Signed-off-by: Michal Hocko <mhocko@suse.com>

---
 net/Makefile |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/net/Makefile
+++ b/net/Makefile
@@ -30,7 +30,7 @@ obj-$(CONFIG_X25)		+= x25/
 obj-$(CONFIG_LAPB)		+= lapb/
 obj-$(CONFIG_NETROM)		+= netrom/
 obj-$(CONFIG_ROSE)		+= rose/
-obj-$(CONFIG_AX25)		+= ax25/
+obj-$(CONFIG_AX25_REMOVED)	+= ax25/
 obj-$(CONFIG_CAN)		+= can/
 obj-$(CONFIG_BT)		+= bluetooth/
 obj-$(CONFIG_SUNRPC)		+= sunrpc/
