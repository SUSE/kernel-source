From: Steffen Jaeckel <sjaeckel@suse.de>
Subject: kABI fix for "Bluetooth: L2CAP: Fix div-by-zero in
 l2cap_le_flowctl_init()"
Patch-mainline: never, kabi
References: CVE-2024-36968 bsc#1226130

Signed-off-by: Steffen Jaeckel <sjaeckel@suse.de>

---
 include/net/bluetooth/hci_core.h | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/include/net/bluetooth/hci_core.h b/include/net/bluetooth/hci_core.h
index 05c9e1d2c2a79..0a5d03e3cfb52 100644
--- a/include/net/bluetooth/hci_core.h
+++ b/include/net/bluetooth/hci_core.h
@@ -706,7 +706,6 @@ struct hci_conn {
 	__u16		handle;
 	__u16		sync_handle;
 	__u16		state;
-	__u16		mtu;
 	__u8		mode;
 	__u8		type;
 	__u8		role;
@@ -723,6 +722,9 @@ struct hci_conn {
 	__u8		pin_length;
 	__u8		enc_key_size;
 	__u8		io_capability;
+#ifndef __GENKSYMS__
+	__u16		mtu;
+#endif
 	__u32		passkey_notify;
 	__u8		passkey_entered;
 	__u16		disc_timeout;
-- 
2.47.0

