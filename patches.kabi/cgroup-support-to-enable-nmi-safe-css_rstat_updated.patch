From: Petr Tesarik <ptesarik@suse.com>
Date: Thue, 26 Jun 2025 13:11:31 +0200
Subject: kabi: restore layout of struct cgroup_rstat_cpu
Patch-mainline: Never, kabi workaround
References: bsc#1247963

Struct cgroup_rstat_cpu is allocated only by cgroup_rstat_init(), except
the default root (cgrp_dfl_root_rstat_cpu), which is allocated statically.
Both places are kernel-internal, so adding new fields at the end is safe.

Signed-off-by: Petr Tesarik <ptesarik@suse.com>
Reviewed-by: Jan Kara <jack@suse.cz>

---
 include/linux/cgroup-defs.h |    2 ++
 1 file changed, 2 insertions(+)

--- a/include/linux/cgroup-defs.h
+++ b/include/linux/cgroup-defs.h
@@ -396,8 +396,10 @@ struct cgroup_rstat_cpu {
 	struct cgroup *updated_children;	/* terminated by self cgroup */
 	struct cgroup *updated_next;		/* NULL iff not on the list */
 
+#ifndef __GENKSYMS__
 	struct llist_node lnode;		/* lockless list for update */
 	struct cgroup *owner;			/* back pointer */
+#endif
 };
 
 struct cgroup_freezer_state {
