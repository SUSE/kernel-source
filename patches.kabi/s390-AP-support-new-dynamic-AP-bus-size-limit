From: Petr Tesarik <ptesarik@suse.com>
Date: Mon, 14 Feb 2022 13:00:13 +0100
Subject: kabi: Hide changes to s390/AP structures
Patch-mainline: Never, kabi workaround
References: jsc#SLE-20807

Kernel commit bd39654a2282c1a51c044575a6bc00d641d5dfd1 adds these new
fields:

- struct ap_card: unsigned int maxmsgsize
  Fits into the hole at offset 497, reducing its size to 3 bytes.

- struct ap_message: unsigned int bufsize
  Fits into the hole at offset 44, filling it completely.

Signed-off-by: Petr Tesarik <ptesarik@suse.com>

---
 drivers/s390/crypto/ap_bus.h |    8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

--- a/drivers/s390/crypto/ap_bus.h
+++ b/drivers/s390/crypto/ap_bus.h
@@ -173,8 +173,10 @@ struct ap_card {
 	unsigned int functions;		/* AP device function bitfield. */
 	int queue_depth;		/* AP queue depth.*/
 	int id;				/* AP card number. */
-	unsigned int maxmsgsize;	/* AP msg limit for this card */
 	bool config;			/* configured state */
+#ifndef __GENKSYMS__
+	unsigned int maxmsgsize;	/* AP msg limit for this card */
+#endif
 	atomic64_t total_request_count;	/* # requests ever for this AP device.*/
 };
 
@@ -236,10 +238,12 @@ struct ap_message {
 	unsigned long long psmid;	/* Message id. */
 	void *msg;			/* Pointer to message buffer. */
 	unsigned int len;		/* actual msg len in msg buffer */
-	unsigned int bufsize;		/* allocated msg buffer size */
 	u16 flags;			/* Flags, see AP_MSG_FLAG_xxx */
 	struct ap_fi fi;		/* Failure Injection cmd */
 	int rc;				/* Return code for this message */
+#ifndef __GENKSYMS__
+	unsigned int bufsize;		/* allocated msg buffer size */
+#endif
 	void *private;			/* ap driver private pointer. */
 	/* receive is called from tasklet context */
 	void (*receive)(struct ap_queue *, struct ap_message *,
