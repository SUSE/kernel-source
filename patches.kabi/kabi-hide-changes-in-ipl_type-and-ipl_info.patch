From: Miroslav Franc <mfranc@suse.cz>
Date: Wed, 13 Sep 2023 10:01:52 +0200
Subject: kabi: hide changes in enum ipl_type and struct sclp_info
Patch-mainline: never, kabi workaround
References: jsc#PED-2023 jsc#PED-2025

The previous 2 patches extend enum ipl_type.  According to ELF s390x psABI
document, the enum is at least 4 byte int type, which means that extending enum
ipl_type with 2 small numbers won't change its size or alignment.  So, mask the
extension from kabi-check.

struct ipl_info contains union of several structs.  But eckd struct which was
added in the first patch contains the same type as ccw that which was already
present, which means that the size or alignment of the union and the entire
struct ipl_info won't change either.  Thus, mask the extension from kabi-check.

Signed-off-by: Miroslav Franc <mfranc@suse.cz>
---
 arch/s390/include/asm/ipl.h | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/arch/s390/include/asm/ipl.h b/arch/s390/include/asm/ipl.h
index b22ae92e3..d2c6519e1 100644
--- a/arch/s390/include/asm/ipl.h
+++ b/arch/s390/include/asm/ipl.h
@@ -72,8 +72,10 @@
 	IPL_TYPE_NSS		= 16,
 	IPL_TYPE_NVME		= 32,
 	IPL_TYPE_NVME_DUMP	= 64,
+#ifndef __GENKSYMS__
 	IPL_TYPE_ECKD		= 128,
 	IPL_TYPE_ECKD_DUMP	= 256,
+#endif
 };
 
 struct ipl_info
@@ -83,9 +85,11 @@
 		struct {
 			struct ccw_dev_id dev_id;
 		} ccw;
+#ifndef __GENKSYMS__
 		struct {
 			struct ccw_dev_id dev_id;
 		} eckd;
+#endif
 		struct {
 			struct ccw_dev_id dev_id;
 			u64 wwpn;
