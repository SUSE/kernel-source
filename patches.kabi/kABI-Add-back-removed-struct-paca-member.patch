From 2b6f94680e6e17e6936588230c061471411464ef Mon Sep 17 00:00:00 2001
From: Michal Suchanek <msuchanek@suse.de>
Date: Thu, 29 Sep 2022 10:05:49 +0200
Subject: [PATCH] kABI: Add back removed struct paca member.

References: bsc#1203664 ltc#199236

Add back removed struct member, and rename it for non-genksyms so that
code using it will not compile.

Signed-off-by: Michal Suchanek <msuchanek@suse.de>
---
 arch/powerpc/include/asm/paca.h | 5 +++++
 arch/powerpc/kernel/paca.c      | 3 +++
 2 files changed, 8 insertions(+)

diff --git a/arch/powerpc/include/asm/paca.h b/arch/powerpc/include/asm/paca.h
index c5c9e2515315..681af8f3b0dc 100644
--- a/arch/powerpc/include/asm/paca.h
+++ b/arch/powerpc/include/asm/paca.h
@@ -263,6 +263,11 @@ struct paca_struct {
 	u64 l1d_flush_size;
 #endif
 #ifdef CONFIG_PPC_PSERIES
+#ifdef __GENKSYMS__
+	struct rtas_args *rtas_args_reentrant;
+#else
+	struct rtas_args *unused;
+#endif
 	u8 *mce_data_buf;		/* buffer to hold per cpu rtas errlog */
 #endif /* CONFIG_PPC_PSERIES */
 
diff --git a/arch/powerpc/kernel/paca.c b/arch/powerpc/kernel/paca.c
index 2de557663a96..69e33df8a76b 100644
--- a/arch/powerpc/kernel/paca.c
+++ b/arch/powerpc/kernel/paca.c
@@ -16,6 +16,9 @@
 #include <asm/kexec.h>
 #include <asm/svm.h>
 #include <asm/ultravisor.h>
+#ifdef __GENKSYMS__
+#include <asm/rtas.h>
+#endif
 
 #include "setup.h"
 
-- 
2.35.3

