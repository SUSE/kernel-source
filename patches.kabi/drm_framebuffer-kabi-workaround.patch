From: Takashi Iwai <tiwai@suse.de>
Subject: kABI workaround for struct drm_framebuffer changes
Patch-mainline: Never, kABI workaround
References: git-fixes

patches.suse/drm-framebuffer-Acquire-internal-references-on-GEM-h.patch
introduced a new field, internal_flags, to the struct frame_buffer.
In order to keep kABI compatibility, move it to a 4-bytes hole.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/drm/drm_framebuffer.h |   11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

--- a/include/drm/drm_framebuffer.h
+++ b/include/drm/drm_framebuffer.h
@@ -192,10 +192,6 @@ struct drm_framebuffer {
 	 */
 	int flags;
 	/**
-	 * @internal_flags: Framebuffer flags like DRM_FRAMEBUFFER_HAS_HANDLE_REF.
-	 */
-	unsigned int internal_flags;
-	/**
 	 * @hot_x: X coordinate of the cursor hotspot. Used by the legacy cursor
 	 * IOCTL when the driver supports cursor through a DRM_PLANE_TYPE_CURSOR
 	 * universal plane.
@@ -207,6 +203,13 @@ struct drm_framebuffer {
 	 * universal plane.
 	 */
 	int hot_y;
+#ifndef __GENKSYMS__
+	/* FIXME: put into a 4-bytes hole for kABI compatibility */
+	/**
+	 * @internal_flags: Framebuffer flags like DRM_FRAMEBUFFER_HAS_HANDLE_REF.
+	 */
+	unsigned int internal_flags;
+#endif
 	/**
 	 * @filp_head: Placed on &drm_file.fbs, protected by &drm_file.fbs_lock.
 	 */
