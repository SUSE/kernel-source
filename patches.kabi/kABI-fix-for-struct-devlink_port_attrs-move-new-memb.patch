From d1efabbf87349edf31fef73c824ad12befea8cd3 Mon Sep 17 00:00:00 2001
From: Thomas Abraham <tabraham@suse.com>
Date: Wed, 20 Aug 2025 18:25:28 -0400
Subject: [PATCH] kABI: fix for struct devlink_port_attrs: move new member to
 the end
References: git-fixes
Patch-mainline: Never, kABI workaround

upstream commit c5ec7f49b480db0dfc83f395755b1c2a7c979920
("devlink: let driver opt out of automatic phys_port_name generation")
changes the layout of struct devlink_port_attrs.

Signed-off-by: Thomas Abraham <tabraham@suse.com>
---
 include/net/devlink.h | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/include/net/devlink.h b/include/net/devlink.h
index 6745fcffa09a1..68f09591ff0fe 100644
--- a/include/net/devlink.h
+++ b/include/net/devlink.h
@@ -83,6 +83,9 @@ struct devlink_port_pci_sf_attrs {
  * @pci_pf: PCI PF port attributes
  * @pci_vf: PCI VF port attributes
  * @pci_sf: PCI SF port attributes
+ * @no_phys_port_name: skip automatic phys_port_name generation; for
+ *                     compatibility only, newly added driver/port instance
+ *                     should never set this.
  */
 struct devlink_port_attrs {
 	u8 split:1,
@@ -96,6 +99,9 @@ struct devlink_port_attrs {
 		struct devlink_port_pci_vf_attrs pci_vf;
 		struct devlink_port_pci_sf_attrs pci_sf;
 	};
+#ifndef __GENKSYMS__
+	u8 no_phys_port_name:1;
+#endif
 };
 
 struct devlink_rate {
-- 
2.43.0

