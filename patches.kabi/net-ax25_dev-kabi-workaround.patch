From: Takashi Iwai <tiwai@suse.de>
Subject: net: kABI workaround for ax25_dev
Patch-mainline: Never, kABI workaround
References: CVE-2022-1199 bsc#1198028

The recent fix for ax25 added a new field to ax25_dev struct.
Let's hide it with the standard __GENKSYMS__ trick for kABI
compatibility, as the struct is kmalloced internally in ax25 core
itself.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/net/ax25.h |    2 ++
 1 file changed, 2 insertions(+)

--- a/include/net/ax25.h
+++ b/include/net/ax25.h
@@ -236,7 +236,9 @@ typedef struct ax25_dev {
 #if defined(CONFIG_AX25_DAMA_SLAVE) || defined(CONFIG_AX25_DAMA_MASTER)
 	ax25_dama_info		dama;
 #endif
+#ifndef __GENKSYMS__
 	refcount_t		refcount;
+#endif
 } ax25_dev;
 
 typedef struct ax25_cb {
