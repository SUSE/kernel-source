From: Olaf Hering <ohering@suse.de>
Date: Tue, 23 May 2023 10:14:21 -0700
Patch-mainline: never, kABI
Subject: kabi: x86/hyperv: Fix hyperv_pcpu_input_arg handling when CPUs go online/offline
References: bsc#1206453

CPUHP_AP_HYPERV_ONLINE needs to run before CPUHP_AP_IRQ_AFFINITY_ONLINE
It needs to be an otherwise unused slot in cpuhp_hp_states.
Thankfully CPUHP_AP_X86_VDSO_VMA_ONLINE was not removed with commit 
b2e2ba578e01 ("x86/vdso: Initialize the CPU/node NR segment descriptor earlier")
--- a/include/linux/cpuhotplug.h
+++ b/include/linux/cpuhotplug.h
@@ -199,10 +199,10 @@ enum cpuhp_state {
 
 	/* Online section invoked on the hotplugged CPU from the hotplug thread */
 	CPUHP_AP_ONLINE_IDLE,
-	CPUHP_AP_HYPERV_ONLINE,
 	CPUHP_AP_SCHED_WAIT_EMPTY,
 	CPUHP_AP_SMPBOOT_THREADS,
 	CPUHP_AP_X86_VDSO_VMA_ONLINE,
+#define CPUHP_AP_HYPERV_ONLINE	CPUHP_AP_X86_VDSO_VMA_ONLINE /* kABI */
 	CPUHP_AP_IRQ_AFFINITY_ONLINE,
 	CPUHP_AP_BLK_MQ_ONLINE,
 	CPUHP_AP_ARM_MVEBU_SYNC_CLOCKS,
