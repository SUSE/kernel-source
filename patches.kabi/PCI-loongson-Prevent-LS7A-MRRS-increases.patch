From: Jiri Slaby <jslaby@suse.cz>
Subject: kABI: PCI: loongson: Prevent LS7A MRRS increases
Patch-mainline: never, kabi
References: kabi

Commit 8b3517f88ff2 (PCI: loongson: Prevent LS7A MRRS increases) added a
bit to struct pci_host_bridge. This changed the layout of the structure
and the kABI checker complains.

Move the new bit to the end of the bitfield as there is a hole. Note the
order and the hole is the same on both BE and LE. And protect the new
member by the usual __GENKSYMS__ protection.

Signed-off-by: Jiri Slaby <jslaby@suse.cz>
---
 include/linux/pci.h |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/include/linux/pci.h
+++ b/include/linux/pci.h
@@ -564,7 +564,6 @@ struct pci_host_bridge {
 	void		*release_data;
 	unsigned int	ignore_reset_delay:1;	/* For entire hierarchy */
 	unsigned int	no_ext_tags:1;		/* No Extended Tags */
-	unsigned int	no_inc_mrrs:1;		/* No Increase MRRS */
 	unsigned int	native_aer:1;		/* OS may use PCIe AER */
 	unsigned int	native_pcie_hotplug:1;	/* OS may use PCIe hotplug */
 	unsigned int	native_shpc_hotplug:1;	/* OS may use SHPC hotplug */
@@ -574,6 +573,9 @@ struct pci_host_bridge {
 	unsigned int	preserve_config:1;	/* Preserve FW resource setup */
 	unsigned int	size_windows:1;		/* Enable root bus sizing */
 	unsigned int	msi_domain:1;		/* Bridge wants MSI domain */
+#ifndef __GENKSYMS__
+	unsigned int	no_inc_mrrs:1;		/* No Increase MRRS */
+#endif
 
 	void* suse_kabi_padding;
 
