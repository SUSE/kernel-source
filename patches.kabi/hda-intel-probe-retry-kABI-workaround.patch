From: Takashi Iwai <tiwai@suse.de>
Subject: kABI workaround for HD-audio probe retry changes
Patch-mainline: Never, kABI workaround
References: bsc#1190801

The patch
  patches.suse/ALSA-hda-intel-Allow-repeatedly-probing-on-codec-con.patch
introduced a few kABI breakage due to the newly added bit field in
struct hda_codec and the inclusion of hda_local.h.
Shuffle and wrap them via the standard __GENKSYMS__ trick.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/sound/hda_codec.h      |    4 +++-
 sound/pci/hda/hda_controller.c |    2 ++
 2 files changed, 5 insertions(+), 1 deletion(-)

--- a/include/sound/hda_codec.h
+++ b/include/sound/hda_codec.h
@@ -225,7 +225,6 @@ struct hda_codec {
 #endif
 
 	/* misc flags */
-	unsigned int configured:1; /* codec was configured */
 	unsigned int in_freeing:1; /* being released */
 	unsigned int registered:1; /* codec was registered */
 	unsigned int display_power_control:1; /* needs display power */
@@ -256,6 +255,9 @@ struct hda_codec {
 	unsigned int relaxed_resume:1;	/* don't resume forcibly for jack */
 	unsigned int forced_resume:1; /* forced resume for jack */
 	unsigned int mst_no_extra_pcms:1; /* no backup PCMs for DP-MST */
+#ifndef __GENKSYMS__
+	unsigned int configured:1; /* codec was configured */
+#endif
 
 #ifdef CONFIG_PM
 	unsigned long power_on_acct;
--- a/sound/pci/hda/hda_controller.c
+++ b/sound/pci/hda/hda_controller.c
@@ -25,7 +25,9 @@
 #include <sound/core.h>
 #include <sound/initval.h>
 #include "hda_controller.h"
+#ifndef __GENKSYMS__
 #include "hda_local.h"
+#endif
 
 #define CREATE_TRACE_POINTS
 #include "hda_controller_trace.h"
