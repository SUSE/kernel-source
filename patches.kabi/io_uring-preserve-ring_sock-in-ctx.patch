From: Gabriel Krisman Bertazi <krisman@suse.de>
Subject: io_uring: preserve ring sock in ctx 
Patch-mainline: Never, kabi
References: git-fixes CVE-2023-52656 bsc#1224187

 ->ring_sock was dropped by commit commit 6e5e6d274956 ("io_uring: drop
any code related to SCM_RIGHTS") but it is an internal field. Annotate
it as as opportunity for later padding.

---
 include/linux/io_uring_types.h |   14 ++++++++++++++
 1 file changed, 14 insertions(+)

--- a/include/linux/io_uring_types.h
+++ b/include/linux/io_uring_types.h
@@ -351,6 +351,19 @@ struct io_ring_ctx {
 	struct wait_queue_head		rsrc_quiesce_wq;
 	unsigned			rsrc_quiesce;
 
+	#if defined(CONFIG_UNIX)
+
+	#ifdef __GENKSYMS__
+		/*
+		 * Unused. preserved kabi. See upstream commit:
+		 * 6e5e6d274956 ("io_uring: drop any code related to SCM_RIGHTS")
+		 */
+		struct socket		*ring_sock;
+	#else
+		void			*kabi_pad2;
+	#endif
+
+	#endif
 	/* hashed buffered write serialization */
 	struct io_wq_hash		*hash_map;
 
